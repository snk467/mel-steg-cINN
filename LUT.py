import exceptions
import numpy as np
import torch
    
# region Utilities

def scale_parula_lab():
    cm = Colormap.from_colormap()

    im = np.array(cm.get_colormaps()["parula_lab"])
    offsets = [0.0, 128., 128.]
    scales = [100., 255., 255.]
    for i in range(3):
        im[:, i] = (im[:, i] + offsets[i]) / scales[i]

    print(im)

# endregion

class Colormap:

    colormaps = {
        "parula_rgb": [[0.2422, 0.1504, 0.6603],
[0.2444, 0.1534, 0.6728],
[0.2464, 0.1569, 0.6847],
[0.2484, 0.1607, 0.6961],
[0.2503, 0.1648, 0.7071],
[0.2522, 0.1689, 0.7179],
[0.254, 0.1732, 0.7286],
[0.2558, 0.1773, 0.7393],
[0.2576, 0.1814, 0.7501],
[0.2594, 0.1854, 0.761],
[0.2611, 0.1893, 0.7719],
[0.2628, 0.1932, 0.7828],
[0.2645, 0.1972, 0.7937],
[0.2661, 0.2011, 0.8043],
[0.2676, 0.2052, 0.8148],
[0.2691, 0.2094, 0.8249],
[0.2704, 0.2138, 0.8346],
[0.2717, 0.2184, 0.8439],
[0.2729, 0.2231, 0.8528],
[0.274, 0.228, 0.8612],
[0.2749, 0.233, 0.8692],
[0.2758, 0.2382, 0.8767],
[0.2766, 0.2435, 0.884],
[0.2774, 0.2489, 0.8908],
[0.2781, 0.2543, 0.8973],
[0.2788, 0.2598, 0.9035],
[0.2794, 0.2653, 0.9094],
[0.2798, 0.2708, 0.915],
[0.2802, 0.2764, 0.9204],
[0.2806, 0.2819, 0.9255],
[0.2809, 0.2875, 0.9305],
[0.2811, 0.293, 0.9352],
[0.2813, 0.2985, 0.9397],
[0.2814, 0.304, 0.9441],
[0.2814, 0.3095, 0.9483],
[0.2813, 0.315, 0.9524],
[0.2811, 0.3204, 0.9563],
[0.2809, 0.3259, 0.96],
[0.2807, 0.3313, 0.9636],
[0.2803, 0.3367, 0.967],
[0.2798, 0.3421, 0.9702],
[0.2791, 0.3475, 0.9733],
[0.2784, 0.3529, 0.9763],
[0.2776, 0.3583, 0.9791],
[0.2766, 0.3638, 0.9817],
[0.2754, 0.3693, 0.984],
[0.2741, 0.3748, 0.9862],
[0.2726, 0.3804, 0.9881],
[0.271, 0.386, 0.9898],
[0.2691, 0.3916, 0.9912],
[0.267, 0.3973, 0.9924],
[0.2647, 0.403, 0.9935],
[0.2621, 0.4088, 0.9946],
[0.2591, 0.4145, 0.9955],
[0.2556, 0.4203, 0.9965],
[0.2517, 0.4261, 0.9974],
[0.2473, 0.4319, 0.9983],
[0.2424, 0.4378, 0.9991],
[0.2369, 0.4437, 0.9996],
[0.2311, 0.4497, 0.9995],
[0.225, 0.4559, 0.9985],
[0.2189, 0.462, 0.9968],
[0.2128, 0.4682, 0.9948],
[0.2066, 0.4743, 0.9926],
[0.2006, 0.4803, 0.9906],
[0.195, 0.4861, 0.9887],
[0.1903, 0.4919, 0.9867],
[0.1869, 0.4975, 0.9844],
[0.1847, 0.503, 0.9819],
[0.1831, 0.5084, 0.9793],
[0.1818, 0.5138, 0.9766],
[0.1806, 0.5191, 0.9738],
[0.1795, 0.5244, 0.9709],
[0.1785, 0.5296, 0.9677],
[0.1778, 0.5349, 0.9641],
[0.1773, 0.5401, 0.9602],
[0.1768, 0.5452, 0.956],
[0.1764, 0.5504, 0.9516],
[0.1755, 0.5554, 0.9473],
[0.174, 0.5605, 0.9432],
[0.1716, 0.5655, 0.9393],
[0.1686, 0.5705, 0.9357],
[0.1649, 0.5755, 0.9323],
[0.161, 0.5805, 0.9289],
[0.1573, 0.5854, 0.9254],
[0.154, 0.5902, 0.9218],
[0.1513, 0.595, 0.9182],
[0.1492, 0.5997, 0.9147],
[0.1475, 0.6043, 0.9113],
[0.1461, 0.6089, 0.908],
[0.1446, 0.6135, 0.905],
[0.1429, 0.618, 0.9022],
[0.1408, 0.6226, 0.8998],
[0.1383, 0.6272, 0.8975],
[0.1354, 0.6317, 0.8953],
[0.1321, 0.6363, 0.8932],
[0.1288, 0.6408, 0.891],
[0.1253, 0.6453, 0.8887],
[0.1219, 0.6497, 0.8862],
[0.1185, 0.6541, 0.8834],
[0.1152, 0.6584, 0.8804],
[0.1119, 0.6627, 0.877],
[0.1085, 0.6669, 0.8734],
[0.1048, 0.671, 0.8695],
[0.1009, 0.675, 0.8653],
[0.0964, 0.6789, 0.8609],
[0.0914, 0.6828, 0.8562],
[0.0855, 0.6865, 0.8513],
[0.0789, 0.6902, 0.8462],
[0.0713, 0.6938, 0.8409],
[0.0628, 0.6972, 0.8355],
[0.0535, 0.7006, 0.8299],
[0.0433, 0.7039, 0.8242],
[0.0328, 0.7071, 0.8183],
[0.0234, 0.7103, 0.8124],
[0.0155, 0.7133, 0.8064],
[0.0091, 0.7163, 0.8003],
[0.0046, 0.7192, 0.7941],
[0.0019, 0.722, 0.7878],
[0.0009, 0.7248, 0.7815],
[0.0018, 0.7275, 0.7752],
[0.0046, 0.7301, 0.7688],
[0.0094, 0.7327, 0.7623],
[0.0162, 0.7352, 0.7558],
[0.0253, 0.7376, 0.7492],
[0.0369, 0.74, 0.7426],
[0.0504, 0.7423, 0.7359],
[0.0638, 0.7446, 0.7292],
[0.077, 0.7468, 0.7224],
[0.0899, 0.7489, 0.7156],
[0.1023, 0.751, 0.7088],
[0.1141, 0.7531, 0.7019],
[0.1252, 0.7552, 0.695],
[0.1354, 0.7572, 0.6881],
[0.1448, 0.7593, 0.6812],
[0.1532, 0.7614, 0.6741],
[0.1609, 0.7635, 0.6671],
[0.1678, 0.7656, 0.6599],
[0.1741, 0.7678, 0.6527],
[0.1799, 0.7699, 0.6454],
[0.1853, 0.7721, 0.6379],
[0.1905, 0.7743, 0.6303],
[0.1954, 0.7765, 0.6225],
[0.2003, 0.7787, 0.6146],
[0.2061, 0.7808, 0.6065],
[0.2118, 0.7828, 0.5983],
[0.2178, 0.7849, 0.5899],
[0.2244, 0.7869, 0.5813],
[0.2318, 0.7887, 0.5725],
[0.2401, 0.7905, 0.5636],
[0.2491, 0.7922, 0.5546],
[0.2589, 0.7937, 0.5454],
[0.2695, 0.7951, 0.536],
[0.2809, 0.7964, 0.5266],
[0.2929, 0.7975, 0.517],
[0.3052, 0.7985, 0.5074],
[0.3176, 0.7994, 0.4975],
[0.3301, 0.8002, 0.4876],
[0.3424, 0.8009, 0.4774],
[0.3548, 0.8016, 0.4669],
[0.3671, 0.8021, 0.4563],
[0.3795, 0.8026, 0.4454],
[0.3921, 0.8029, 0.4344],
[0.405, 0.8031, 0.4233],
[0.4184, 0.803, 0.4122],
[0.4322, 0.8028, 0.4013],
[0.4463, 0.8024, 0.3904],
[0.4608, 0.8018, 0.3797],
[0.4753, 0.8011, 0.3691],
[0.4899, 0.8002, 0.3586],
[0.5044, 0.7993, 0.348],
[0.5187, 0.7982, 0.3374],
[0.5329, 0.797, 0.3267],
[0.547, 0.7957, 0.3159],
[0.5609, 0.7943, 0.305],
[0.5748, 0.7929, 0.2941],
[0.5886, 0.7913, 0.2833],
[0.6024, 0.7896, 0.2726],
[0.6161, 0.7878, 0.2622],
[0.6297, 0.7859, 0.2521],
[0.6433, 0.7839, 0.2423],
[0.6567, 0.7818, 0.2329],
[0.6701, 0.7796, 0.2239],
[0.6833, 0.7773, 0.2155],
[0.6963, 0.775, 0.2075],
[0.7091, 0.7727, 0.1998],
[0.7218, 0.7703, 0.1924],
[0.7344, 0.7679, 0.1852],
[0.7468, 0.7654, 0.1782],
[0.759, 0.7629, 0.1717],
[0.771, 0.7604, 0.1658],
[0.7829, 0.7579, 0.1608],
[0.7945, 0.7554, 0.157],
[0.806, 0.7529, 0.1546],
[0.8172, 0.7505, 0.1535],
[0.8281, 0.7481, 0.1536],
[0.8389, 0.7457, 0.1546],
[0.8495, 0.7435, 0.1564],
[0.86, 0.7413, 0.1587],
[0.8703, 0.7392, 0.1615],
[0.8804, 0.7372, 0.165],
[0.8903, 0.7353, 0.1695],
[0.9, 0.7336, 0.1749],
[0.9093, 0.7321, 0.1815],
[0.9184, 0.7308, 0.189],
[0.9272, 0.7298, 0.1973],
[0.9357, 0.729, 0.2061],
[0.944, 0.7285, 0.2151],
[0.9523, 0.7284, 0.2237],
[0.9606, 0.7285, 0.2312],
[0.9689, 0.7292, 0.2373],
[0.977, 0.7304, 0.2418],
[0.9842, 0.733, 0.2446],
[0.99, 0.7365, 0.2429],
[0.9946, 0.7407, 0.2394],
[0.9966, 0.7458, 0.2351],
[0.9971, 0.7513, 0.2309],
[0.9972, 0.7569, 0.2267],
[0.9971, 0.7626, 0.2224],
[0.9969, 0.7683, 0.2181],
[0.9966, 0.774, 0.2138],
[0.9962, 0.7798, 0.2095],
[0.9957, 0.7856, 0.2053],
[0.9949, 0.7915, 0.2012],
[0.9938, 0.7974, 0.1974],
[0.9923, 0.8034, 0.1939],
[0.9906, 0.8095, 0.1906],
[0.9885, 0.8156, 0.1875],
[0.9861, 0.8218, 0.1846],
[0.9835, 0.828, 0.1817],
[0.9807, 0.8342, 0.1787],
[0.9778, 0.8404, 0.1757],
[0.9748, 0.8467, 0.1726],
[0.972, 0.8529, 0.1695],
[0.9694, 0.8591, 0.1665],
[0.9671, 0.8654, 0.1636],
[0.9651, 0.8716, 0.1608],
[0.9634, 0.8778, 0.1582],
[0.9619, 0.884, 0.1557],
[0.9608, 0.8902, 0.1532],
[0.9601, 0.8963, 0.1507],
[0.9596, 0.9023, 0.148],
[0.9595, 0.9084, 0.145],
[0.9597, 0.9143, 0.1418],
[0.9601, 0.9203, 0.1382],
[0.9608, 0.9262, 0.1344],
[0.9618, 0.932, 0.1304],
[0.9629, 0.9379, 0.1261],
[0.9642, 0.9437, 0.1216],
[0.9657, 0.9494, 0.1168],
[0.9674, 0.9552, 0.1116],
[0.9692, 0.9609, 0.1061],
[0.9711, 0.9667, 0.1001],
[0.973, 0.9724, 0.0938],
[0.9749, 0.9782, 0.0872],
[0.9769, 0.9839, 0.0805]],
        "parula_lab": [[ 2.74782051e+01,  4.68630472e+01, -6.55028698e+01],
       [ 2.79912715e+01,  4.75048912e+01, -6.65738490e+01],
       [ 2.85059096e+01,  4.80291747e+01, -6.75441553e+01],
       [ 2.90202195e+01,  4.84754507e+01, -6.84329968e+01],
       [ 2.95347980e+01,  4.88483700e+01, -6.92554426e+01],
       [ 3.00435716e+01,  4.92049454e+01, -7.00523394e+01],
       [ 3.05562309e+01,  4.95239923e+01, -7.08232077e+01],
       [ 3.10592327e+01,  4.98682542e+01, -7.16055752e+01],
       [ 3.15642651e+01,  5.02194982e+01, -7.23952501e+01],
       [ 3.20666714e+01,  5.05909231e+01, -7.31998643e+01],
       [ 3.25618366e+01,  5.09721347e+01, -7.40121119e+01],
       [ 3.30563853e+01,  5.13527823e+01, -7.48210657e+01],
       [ 3.35549544e+01,  5.17196702e+01, -7.56191431e+01],
       [ 3.40386653e+01,  5.20731536e+01, -7.63931563e+01],
       [ 3.45267138e+01,  5.23891788e+01, -7.71413972e+01],
       [ 3.50087812e+01,  5.26600940e+01, -7.78367372e+01],
       [ 3.54860322e+01,  5.28671646e+01, -7.84778406e+01],
       [ 3.59624244e+01,  5.30152793e+01, -7.90584881e+01],
       [ 3.64316521e+01,  5.31148380e+01, -7.95895544e+01],
       [ 3.68962497e+01,  5.31441432e+01, -8.00526146e+01],
       [ 3.73525453e+01,  5.31214697e+01, -8.04688291e+01],
       [ 3.78067048e+01,  5.30300131e+01, -8.08136697e+01],
       [ 3.82599113e+01,  5.29040660e+01, -8.11292970e+01],
       [ 3.87067048e+01,  5.27219878e+01, -8.13812221e+01],
       [ 3.91456074e+01,  5.25106027e+01, -8.16013025e+01],
       [ 3.95834293e+01,  5.22583992e+01, -8.17784587e+01],
       [ 4.00136955e+01,  5.19764892e+01, -8.19236060e+01],
       [ 4.04349673e+01,  5.16620945e+01, -8.20393447e+01],
       [ 4.08581249e+01,  5.13142405e+01, -8.21222474e+01],
       [ 4.12705470e+01,  5.09532306e+01, -8.21787879e+01],
       [ 4.16858601e+01,  5.05640512e+01, -8.22155429e+01],
       [ 4.20889913e+01,  5.01590954e+01, -8.22285995e+01],
       [ 4.24890939e+01,  4.97348433e+01, -8.22173492e+01],
       [ 4.28870244e+01,  4.92968755e+01, -8.21948784e+01],
       [ 4.32805644e+01,  4.88369095e+01, -8.21505416e+01],
       [ 4.36720605e+01,  4.83632779e+01, -8.20948866e+01],
       [ 4.40538035e+01,  4.78825287e+01, -8.20263058e+01],
       [ 4.44382867e+01,  4.73676667e+01, -8.19243072e+01],
       [ 4.48166602e+01,  4.68569910e+01, -8.18177780e+01],
       [ 4.51895579e+01,  4.63216446e+01, -8.16915430e+01],
       [ 4.55584670e+01,  4.57643497e+01, -8.15431757e+01],
       [ 4.59243230e+01,  4.51908436e+01, -8.13855021e+01],
       [ 4.62898201e+01,  4.46067552e+01, -8.12140346e+01],
       [ 4.66515604e+01,  4.40007515e+01, -8.10201997e+01],
       [ 4.70142362e+01,  4.33546672e+01, -8.07964210e+01],
       [ 4.73701575e+01,  4.26750420e+01, -8.05411436e+01],
       [ 4.77248800e+01,  4.19819978e+01, -8.02736884e+01],
       [ 4.80791350e+01,  4.12398499e+01, -7.99645630e+01],
       [ 4.84304511e+01,  4.04754888e+01, -7.96320114e+01],
       [ 4.87746171e+01,  3.96745281e+01, -7.92688823e+01],
       [ 4.91211379e+01,  3.88329455e+01, -7.88738171e+01],
       [ 4.94661448e+01,  3.79752271e+01, -7.84673312e+01],
       [ 4.98168142e+01,  3.70920238e+01, -7.80519243e+01],
       [ 5.01560221e+01,  3.61943633e+01, -7.76272929e+01],
       [ 5.05012435e+01,  3.52753270e+01, -7.72074060e+01],
       [ 5.08437463e+01,  3.43359732e+01, -7.67781751e+01],
       [ 5.11847448e+01,  3.33832029e+01, -7.63517895e+01],
       [ 5.15291081e+01,  3.23928908e+01, -7.59061953e+01],
       [ 5.18663245e+01,  3.13607225e+01, -7.54303316e+01],
       [ 5.22006088e+01,  3.02516936e+01, -7.48749422e+01],
       [ 5.25336777e+01,  2.90222659e+01, -7.41950151e+01],
       [ 5.28527788e+01,  2.77456959e+01, -7.34394133e+01],
       [ 5.31784056e+01,  2.64271864e+01, -7.26312705e+01],
       [ 5.34984128e+01,  2.51056990e+01, -7.18044437e+01],
       [ 5.38217885e+01,  2.38261475e+01, -7.10006363e+01],
       [ 5.41408580e+01,  2.25998283e+01, -7.02181279e+01],
       [ 5.44683596e+01,  2.13870697e+01, -6.94079731e+01],
       [ 5.47891590e+01,  2.02085953e+01, -6.85663879e+01],
       [ 5.51103116e+01,  1.90549873e+01, -6.76961092e+01],
       [ 5.54292181e+01,  1.79223885e+01, -6.68156270e+01],
       [ 5.57506938e+01,  1.67886032e+01, -6.59172748e+01],
       [ 5.60665101e+01,  1.56651725e+01, -6.50143860e+01],
       [ 5.63835393e+01,  1.45365527e+01, -6.40958880e+01],
       [ 5.66916569e+01,  1.33996256e+01, -6.31498957e+01],
       [ 5.70045694e+01,  1.22183171e+01, -6.21402150e+01],
       [ 5.73093013e+01,  1.10313864e+01, -6.11018050e+01],
       [ 5.76047502e+01,  9.83462789e+00, -6.00364521e+01],
       [ 5.79072260e+01,  8.60907482e+00, -5.89320594e+01],
       [ 5.81964856e+01,  7.41610210e+00, -5.78635058e+01],
       [ 5.84947799e+01,  6.21684797e+00, -5.68093277e+01],
       [ 5.87862175e+01,  5.03550682e+00, -5.57950379e+01],
       [ 5.90810168e+01,  3.87326383e+00, -5.48183299e+01],
       [ 5.93773457e+01,  2.71919251e+00, -5.38680742e+01],
       [ 5.96750484e+01,  1.56596846e+00, -5.29161859e+01],
       [ 5.99673832e+01,  4.27862134e-01, -5.19591821e+01],
       [ 6.02550899e+01, -6.91275646e-01, -5.09958211e+01],
       [ 6.05474573e+01, -1.79331182e+00, -5.00254102e+01],
       [ 6.08381705e+01, -2.85454176e+00, -4.90720850e+01],
       [ 6.11260784e+01, -3.87939756e+00, -4.81377252e+01],
       [ 6.14179239e+01, -4.88476919e+00, -4.72116978e+01],
       [ 6.17144208e+01, -5.86010070e+00, -4.63211870e+01],
       [ 6.20063922e+01, -6.80217126e+00, -4.54666163e+01],
       [ 6.23102292e+01, -7.72539846e+00, -4.46503527e+01],
       [ 6.26148529e+01, -8.64263287e+00, -4.38476148e+01],
       [ 6.29128622e+01, -9.53929859e+00, -4.30700308e+01],
       [ 6.32192090e+01, -1.04435238e+01, -4.22940783e+01],
       [ 6.35181075e+01, -1.13375547e+01, -4.15163210e+01],
       [ 6.38163511e+01, -1.22389276e+01, -4.07261453e+01],
       [ 6.41063494e+01, -1.31373083e+01, -3.99213208e+01],
       [ 6.43941573e+01, -1.40573088e+01, -3.90783435e+01],
       [ 6.46737494e+01, -1.49742725e+01, -3.82206814e+01],
       [ 6.49501584e+01, -1.59214097e+01, -3.73124035e+01],
       [ 6.52178532e+01, -1.68683718e+01, -3.63902633e+01],
       [ 6.54752689e+01, -1.78267992e+01, -3.54426746e+01],
       [ 6.57228121e+01, -1.87947342e+01, -3.44689543e+01],
       [ 6.59606513e+01, -1.97684844e+01, -3.34829241e+01],
       [ 6.61958064e+01, -2.07677894e+01, -3.24596074e+01],
       [ 6.64134698e+01, -2.17612348e+01, -3.14360224e+01],
       [ 6.66296340e+01, -2.27711100e+01, -3.03873141e+01],
       [ 6.68364518e+01, -2.37857479e+01, -2.93256308e+01],
       [ 6.70279067e+01, -2.47800265e+01, -2.82741815e+01],
       [ 6.72188771e+01, -2.57851484e+01, -2.71959278e+01],
       [ 6.74029502e+01, -2.67779861e+01, -2.61147477e+01],
       [ 6.75798983e+01, -2.77625701e+01, -2.50168765e+01],
       [ 6.77595381e+01, -2.87328892e+01, -2.39153003e+01],
       [ 6.79258562e+01, -2.96699279e+01, -2.28204675e+01],
       [ 6.80942253e+01, -3.05986153e+01, -2.17088655e+01],
       [ 6.82573981e+01, -3.15032315e+01, -2.05915273e+01],
       [ 6.84152196e+01, -3.23843525e+01, -1.94686893e+01],
       [ 6.85761530e+01, -3.32465701e+01, -1.83415388e+01],
       [ 6.87326407e+01, -3.40760790e+01, -1.72215455e+01],
       [ 6.88837798e+01, -3.48808959e+01, -1.60960547e+01],
       [ 6.90374395e+01, -3.56719607e+01, -1.49531898e+01],
       [ 6.91866497e+01, -3.64291847e+01, -1.38175032e+01],
       [ 6.93309027e+01, -3.71580772e+01, -1.26757159e+01],
       [ 6.94789961e+01, -3.78608112e+01, -1.15286266e+01],
       [ 6.96226811e+01, -3.85307821e+01, -1.03746057e+01],
       [ 6.97703172e+01, -3.91729692e+01, -9.21520693e+00],
       [ 6.99132341e+01, -3.97836874e+01, -8.04943355e+00],
       [ 7.00519357e+01, -4.03568502e+01, -6.89054456e+00],
       [ 7.01936109e+01, -4.09077888e+01, -5.72796861e+00],
       [ 7.03369693e+01, -4.14473473e+01, -4.54980044e+00],
       [ 7.04820801e+01, -4.19725192e+01, -3.37005761e+00],
       [ 7.06200529e+01, -4.24793726e+01, -2.20199392e+00],
       [ 7.07662892e+01, -4.29918518e+01, -1.02307490e+00],
       [ 7.09104560e+01, -4.35205786e+01,  1.79127516e-01],
       [ 7.10551461e+01, -4.40409809e+01,  1.36662521e+00],
       [ 7.11976403e+01, -4.45785707e+01,  2.57698339e+00],
       [ 7.13475315e+01, -4.51276234e+01,  3.79623914e+00],
       [ 7.14886720e+01, -4.56719413e+01,  5.01478113e+00],
       [ 7.16363627e+01, -4.62378020e+01,  6.26842691e+00],
       [ 7.17841413e+01, -4.68025152e+01,  7.53388013e+00],
       [ 7.19309332e+01, -4.73756705e+01,  8.82314960e+00],
       [ 7.20786172e+01, -4.79416949e+01,  1.01250540e+01],
       [ 7.22229040e+01, -4.84660764e+01,  1.14476160e+01],
       [ 7.23600306e+01, -4.89738384e+01,  1.27709723e+01],
       [ 7.25070668e+01, -4.94775267e+01,  1.41329251e+01],
       [ 7.26499796e+01, -4.99437840e+01,  1.55135728e+01],
       [ 7.27822685e+01, -5.03520717e+01,  1.69037800e+01],
       [ 7.29211541e+01, -5.07096179e+01,  1.83137609e+01],
       [ 7.30582209e+01, -5.10099667e+01,  1.97313967e+01],
       [ 7.31861940e+01, -5.12401878e+01,  2.11600983e+01],
       [ 7.33135691e+01, -5.14054533e+01,  2.26112475e+01],
       [ 7.34419792e+01, -5.14903499e+01,  2.40598384e+01],
       [ 7.35620591e+01, -5.14993787e+01,  2.55195888e+01],
       [ 7.36810884e+01, -5.14439054e+01,  2.69729693e+01],
       [ 7.37966425e+01, -5.13465621e+01,  2.84559649e+01],
       [ 7.39102088e+01, -5.11921732e+01,  2.99302064e+01],
       [ 7.40183319e+01, -5.10107119e+01,  3.14296910e+01],
       [ 7.41312185e+01, -5.07945781e+01,  3.29671405e+01],
       [ 7.42325801e+01, -5.05261745e+01,  3.44939915e+01],
       [ 7.43389921e+01, -5.02213425e+01,  3.60569597e+01],
       [ 7.44368073e+01, -4.98437678e+01,  3.76118365e+01],
       [ 7.45350451e+01, -4.93953954e+01,  3.91694834e+01],
       [ 7.46210013e+01, -4.88356464e+01,  4.07010470e+01],
       [ 7.47103995e+01, -4.81829383e+01,  4.22006813e+01],
       [ 7.47943275e+01, -4.74395140e+01,  4.36818160e+01],
       [ 7.48749982e+01, -4.65898201e+01,  4.51226341e+01],
       [ 7.49556977e+01, -4.56785322e+01,  4.65382396e+01],
       [ 7.50300726e+01, -4.46878494e+01,  4.79210618e+01],
       [ 7.51105327e+01, -4.36624678e+01,  4.93082351e+01],
       [ 7.51808382e+01, -4.25880703e+01,  5.06675665e+01],
       [ 7.52495261e+01, -4.14712764e+01,  5.20198574e+01],
       [ 7.53165937e+01, -4.03133780e+01,  5.33636010e+01],
       [ 7.53806193e+01, -3.91249469e+01,  5.46952159e+01],
       [ 7.54520668e+01, -3.78982886e+01,  5.60144669e+01],
       [ 7.55148000e+01, -3.66194146e+01,  5.72915346e+01],
       [ 7.55777911e+01, -3.52918906e+01,  5.85362141e+01],
       [ 7.56399011e+01, -3.39236165e+01,  5.97262211e+01],
       [ 7.57010243e+01, -3.25171174e+01,  6.08624551e+01],
       [ 7.57627388e+01, -3.10646760e+01,  6.19481833e+01],
       [ 7.58218037e+01, -2.95873304e+01,  6.29709489e+01],
       [ 7.58815079e+01, -2.80671759e+01,  6.39372414e+01],
       [ 7.59385661e+01, -2.65245897e+01,  6.48270944e+01],
       [ 7.59995786e+01, -2.49773564e+01,  6.56676691e+01],
       [ 7.60640841e+01, -2.34292457e+01,  6.64689058e+01],
       [ 7.61266420e+01, -2.18592579e+01,  6.72277898e+01],
       [ 7.61941020e+01, -2.02826881e+01,  6.79602295e+01],
       [ 7.62573015e+01, -1.86993009e+01,  6.86579434e+01],
       [ 7.63233875e+01, -1.71205105e+01,  6.93058465e+01],
       [ 7.63921588e+01, -1.55474511e+01,  6.98991534e+01],
       [ 7.64657566e+01, -1.39685919e+01,  7.04222596e+01],
       [ 7.65399369e+01, -1.24054500e+01,  7.08529851e+01],
       [ 7.66188767e+01, -1.08365887e+01,  7.11871658e+01],
       [ 7.67045413e+01, -9.29963026e+00,  7.14348902e+01],
       [ 7.67896277e+01, -7.78378041e+00,  7.15979652e+01],
       [ 7.68781264e+01, -6.27025601e+00,  7.17021388e+01],
       [ 7.69807451e+01, -4.79787208e+00,  7.17616181e+01],
       [ 7.70859403e+01, -3.33217699e+00,  7.17871115e+01],
       [ 7.71977581e+01, -1.89783022e+00,  7.17799065e+01],
       [ 7.73161181e+01, -4.93670748e-01,  7.17238055e+01],
       [ 7.74410838e+01,  8.82423848e-01,  7.15939506e+01],
       [ 7.75787459e+01,  2.21639801e+00,  7.13988749e+01],
       [ 7.77240863e+01,  3.48893581e+00,  7.11041382e+01],
       [ 7.78814349e+01,  4.72004773e+00,  7.07326220e+01],
       [ 7.80541612e+01,  5.88517239e+00,  7.02891694e+01],
       [ 7.82351652e+01,  6.99560169e+00,  6.97882357e+01],
       [ 7.84325771e+01,  8.04656337e+00,  6.92621215e+01],
       [ 7.86566202e+01,  9.04075875e+00,  6.87768135e+01],
       [ 7.88933754e+01,  9.99742651e+00,  6.83884909e+01],
       [ 7.91666950e+01,  1.08593950e+01,  6.81551468e+01],
       [ 7.94640895e+01,  1.16158100e+01,  6.80888086e+01],
       [ 7.98211337e+01,  1.20707803e+01,  6.82312449e+01],
       [ 8.01884409e+01,  1.22097883e+01,  6.87981109e+01],
       [ 8.05633277e+01,  1.21100374e+01,  6.95259252e+01],
       [ 8.09224668e+01,  1.16062064e+01,  7.02801285e+01],
       [ 8.12669082e+01,  1.08913491e+01,  7.09874660e+01],
       [ 8.16078882e+01,  1.01220046e+01,  7.16783269e+01],
       [ 8.19507411e+01,  9.31872968e+00,  7.23681953e+01],
       [ 8.22921544e+01,  8.50644698e+00,  7.30459676e+01],
       [ 8.26321604e+01,  7.68518261e+00,  7.37116885e+01],
       [ 8.29770172e+01,  6.84180463e+00,  7.43709808e+01],
       [ 8.33206880e+01,  5.99036374e+00,  7.50104290e+01],
       [ 8.36644205e+01,  5.09617605e+00,  7.56297603e+01],
       [ 8.40023632e+01,  4.17393823e+00,  7.62091428e+01],
       [ 8.43384690e+01,  3.19968023e+00,  7.67526602e+01],
       [ 8.46777948e+01,  2.19419333e+00,  7.72754084e+01],
       [ 8.50092863e+01,  1.14901204e+00,  7.77668539e+01],
       [ 8.53419371e+01,  6.19392736e-02,  7.82367055e+01],
       [ 8.56717689e+01, -1.04458081e+00,  7.86972190e+01],
       [ 8.59987900e+01, -2.17112483e+00,  7.91552866e+01],
       [ 8.63255466e+01, -3.30603567e+00,  7.96070593e+01],
       [ 8.66584268e+01, -4.46272687e+00,  8.00644993e+01],
       [ 8.69915483e+01, -5.58226474e+00,  8.05186425e+01],
       [ 8.73312492e+01, -6.67680931e+00,  8.09685912e+01],
       [ 8.76860945e+01, -7.74835092e+00,  8.14227584e+01],
       [ 8.80428538e+01, -8.77135535e+00,  8.18704096e+01],
       [ 8.84078679e+01, -9.75804553e+00,  8.23113374e+01],
       [ 8.87786523e+01, -1.07198579e+01,  8.27489915e+01],
       [ 8.91592924e+01, -1.16360634e+01,  8.31944344e+01],
       [ 8.95429625e+01, -1.24942106e+01,  8.36419816e+01],
       [ 8.99249956e+01, -1.33170522e+01,  8.40967648e+01],
       [ 9.03225835e+01, -1.41089692e+01,  8.45790719e+01],
       [ 9.07137353e+01, -1.48425674e+01,  8.50638074e+01],
       [ 9.11158779e+01, -1.55671107e+01,  8.55733716e+01],
       [ 9.15179268e+01, -1.62459353e+01,  8.60883351e+01],
       [ 9.19197436e+01, -1.68791802e+01,  8.66077609e+01],
       [ 9.23303117e+01, -1.75133042e+01,  8.71407181e+01],
       [ 9.27384477e+01, -1.81124564e+01,  8.76734524e+01],
       [ 9.31440180e+01, -1.86771744e+01,  8.82091389e+01],
       [ 9.35601803e+01, -1.92324154e+01,  8.87606572e+01],
       [ 9.39716802e+01, -1.97636198e+01,  8.93093417e+01],
       [ 9.43916825e+01, -2.02959198e+01,  8.98710622e+01],
       [ 9.48050246e+01, -2.08144025e+01,  9.04237225e+01],
       [ 9.52250076e+01, -2.13432673e+01,  9.09760800e+01],
       [ 9.56403944e+01, -2.18469594e+01,  9.15129846e+01]],
        "parula_norm_lab": [[0.27478205, 0.68573744, 0.24508679],
        [0.27991271, 0.68825448, 0.24088687],
        [0.2850591 , 0.69031049, 0.23708174],
        [0.29020219, 0.69206059, 0.23359609],
        [0.29534798, 0.69352302, 0.23037081],
        [0.30043572, 0.69492135, 0.22724573],
        [0.30556231, 0.69617252, 0.22422271],
        [0.31059233, 0.69752257, 0.22115461],
        [0.31564265, 0.69889999, 0.21805784],
        [0.32066671, 0.70035656, 0.21490249],
        [0.32561837, 0.70185151, 0.21171721],
        [0.33056385, 0.70334424, 0.20854484],
        [0.33554954, 0.70478302, 0.20541513],
        [0.34038665, 0.70616923, 0.20237978],
        [0.34526714, 0.70740854, 0.1994455 ],
        [0.35008781, 0.70847096, 0.19671868],
        [0.35486032, 0.709283  , 0.19420455],
        [0.35962424, 0.70986384, 0.1919275 ],
        [0.36431652, 0.71025427, 0.18984488],
        [0.3689625 , 0.71036919, 0.18802896],
        [0.37352545, 0.71028027, 0.18639675],
        [0.37806705, 0.70992162, 0.18504443],
        [0.38259911, 0.70942771, 0.18380668],
        [0.38706705, 0.70871368, 0.18281874],
        [0.39145607, 0.70788472, 0.18195568],
        [0.39583429, 0.70689568, 0.18126095],
        [0.40013695, 0.70579015, 0.18069174],
        [0.40434967, 0.70455723, 0.18023786],
        [0.40858125, 0.7031931 , 0.17991276],
        [0.41270547, 0.70177737, 0.17969103],
        [0.4168586 , 0.70025118, 0.17954689],
        [0.42088991, 0.69866312, 0.17949569],
        [0.42489094, 0.69699939, 0.17953981],
        [0.42887024, 0.69528186, 0.17962793],
        [0.43280564, 0.69347808, 0.1798018 ],
        [0.4367206 , 0.6916207 , 0.18002005],
        [0.44053803, 0.68973541, 0.180289  ],
        [0.44438287, 0.68771634, 0.18068899],
        [0.4481666 , 0.68571369, 0.18110675],
        [0.45189558, 0.68361429, 0.18160179],
        [0.45558467, 0.68142882, 0.18218362],
        [0.45924323, 0.67917978, 0.18280195],
        [0.4628982 , 0.67688924, 0.18347437],
        [0.4665156 , 0.67451275, 0.18423451],
        [0.47014236, 0.67197909, 0.18511207],
        [0.47370157, 0.66931389, 0.18611316],
        [0.4772488 , 0.66659607, 0.18716201],
        [0.48079135, 0.66368569, 0.18837426],
        [0.48430451, 0.66068819, 0.18967839],
        [0.48774617, 0.65754717, 0.19110242],
        [0.49121138, 0.65424685, 0.1926517 ],
        [0.49466145, 0.65088324, 0.19424576],
        [0.49816814, 0.6474197 , 0.19587481],
        [0.50156022, 0.64389946, 0.19754003],
        [0.50501244, 0.6402954 , 0.19918664],
        [0.50843746, 0.63661166, 0.2008699 ],
        [0.51184745, 0.63287531, 0.202542  ],
        [0.51529108, 0.62899173, 0.20428943],
        [0.51866324, 0.62494401, 0.20615556],
        [0.52200609, 0.62059488, 0.20833356],
        [0.52533678, 0.61577359, 0.21099994],
        [0.52852779, 0.61076743, 0.21396309],
        [0.53178406, 0.60559681, 0.21713227],
        [0.53498413, 0.60041451, 0.22037473],
        [0.53821789, 0.59539666, 0.22352692],
        [0.54140858, 0.59058756, 0.22659558],
        [0.5446836 , 0.58583165, 0.22977265],
        [0.54789159, 0.58121018, 0.23307299],
        [0.55110312, 0.57668622, 0.23648585],
        [0.55429218, 0.57224466, 0.23993872],
        [0.55750694, 0.56779844, 0.24346167],
        [0.5606651 , 0.56339283, 0.24700241],
        [0.56383539, 0.55896687, 0.25060436],
        [0.56691657, 0.55450834, 0.25431413],
        [0.57004569, 0.54987575, 0.25827367],
        [0.57309301, 0.54522112, 0.26234586],
        [0.5760475 , 0.54052795, 0.26652372],
        [0.57907226, 0.53572186, 0.27085467],
        [0.58196486, 0.53104354, 0.27504508],
        [0.5849478 , 0.52634058, 0.27917911],
        [0.58786218, 0.52170787, 0.28315671],
        [0.59081017, 0.51715005, 0.28698694],
        [0.59377346, 0.51262428, 0.29071343],
        [0.59675048, 0.50810184, 0.29444633],
        [0.59967383, 0.50363868, 0.29819929],
        [0.6025509 , 0.4992499 , 0.30197717],
        [0.60547457, 0.49492819, 0.30578271],
        [0.6083817 , 0.4907665 , 0.30952124],
        [0.61126078, 0.48674746, 0.31318539],
        [0.61417924, 0.48280483, 0.31681687],
        [0.61714421, 0.47898   , 0.32030907],
        [0.62006392, 0.4752856 , 0.32366033],
        [0.62310229, 0.4716651 , 0.32686136],
        [0.62614853, 0.46806811, 0.33000935],
        [0.62912862, 0.46455177, 0.3330587 ],
        [0.63219209, 0.46100579, 0.33610165],
        [0.63518107, 0.45749979, 0.33915168],
        [0.63816351, 0.45396499, 0.34225041],
        [0.64106349, 0.45044193, 0.34540659],
        [0.64394157, 0.44683408, 0.34871238],
        [0.64673749, 0.44323815, 0.35207576],
        [0.64950158, 0.43952388, 0.35563763],
        [0.65217853, 0.43581031, 0.35925387],
        [0.65475269, 0.43205177, 0.3629699 ],
        [0.65722812, 0.42825594, 0.36678841],
        [0.65960651, 0.42443732, 0.3706552 ],
        [0.66195806, 0.42051847, 0.37466821],
        [0.6641347 , 0.41662261, 0.37868227],
        [0.66629634, 0.41266231, 0.38279485],
        [0.66836452, 0.40868334, 0.38695831],
        [0.67027907, 0.40478421, 0.39108164],
        [0.67218877, 0.40084256, 0.39531009],
        [0.6740295 , 0.39694907, 0.39955001],
        [0.67579898, 0.39308796, 0.40385539],
        [0.67759538, 0.38928279, 0.40817529],
        [0.67925856, 0.38560813, 0.41246875],
        [0.68094225, 0.38196621, 0.41682798],
        [0.68257398, 0.3784187 , 0.4212097 ],
        [0.6841522 , 0.37496332, 0.42561298],
        [0.68576153, 0.37158208, 0.43003318],
        [0.68732641, 0.3683291 , 0.43442531],
        [0.6888378 , 0.36517296, 0.438839  ],
        [0.6903744 , 0.36207074, 0.44332082],
        [0.6918665 , 0.35910124, 0.4477745 ],
        [0.69330903, 0.35624283, 0.45225209],
        [0.69478996, 0.35348701, 0.45675048],
        [0.69622681, 0.35085968, 0.46127606],
        [0.69770317, 0.3483413 , 0.46582272],
        [0.69913234, 0.34594632, 0.47039438],
        [0.70051936, 0.34369863, 0.47493904],
        [0.70193611, 0.34153808, 0.47949816],
        [0.70336969, 0.33942217, 0.48411843],
        [0.7048208 , 0.33736267, 0.48874487],
        [0.70620053, 0.33537501, 0.49332551],
        [0.70766289, 0.33336529, 0.49794873],
        [0.70910456, 0.33129185, 0.50266325],
        [0.71055146, 0.32925106, 0.5073201 ],
        [0.7119764 , 0.32714286, 0.5120666 ],
        [0.71347532, 0.32498971, 0.516848  ],
        [0.71488672, 0.32285513, 0.52162659],
        [0.71636363, 0.32063607, 0.52654285],
        [0.71784141, 0.31842151, 0.53150541],
        [0.71930933, 0.31617384, 0.53656137],
        [0.72078617, 0.31395414, 0.54166688],
        [0.72222904, 0.31189774, 0.5468534 ],
        [0.72360031, 0.30990652, 0.55204303],
        [0.72507067, 0.30793127, 0.55738402],
        [0.7264998 , 0.30610281, 0.56279832],
        [0.72782269, 0.30450168, 0.56825012],
        [0.72921154, 0.30309954, 0.57377945],
        [0.73058221, 0.3019217 , 0.57933881],
        [0.73186194, 0.30101887, 0.58494156],
        [0.73313569, 0.30037077, 0.59063234],
        [0.73441979, 0.30003784, 0.59631309],
        [0.73562059, 0.30000244, 0.6020376 ],
        [0.73681088, 0.30021998, 0.60773713],
        [0.73796643, 0.30060172, 0.6135528 ],
        [0.73910209, 0.30120716, 0.61933414],
        [0.74018332, 0.30191878, 0.62521447],
        [0.74131219, 0.30276636, 0.63124369],
        [0.7423258 , 0.30381892, 0.63723134],
        [0.74338992, 0.30501434, 0.64336063],
        [0.74436807, 0.30649503, 0.64945818],
        [0.74535045, 0.30825335, 0.6555666 ],
        [0.74621001, 0.31044845, 0.66157273],
        [0.74710399, 0.31300809, 0.66745365],
        [0.74794327, 0.31592347, 0.67326202],
        [0.74874998, 0.31925561, 0.67891229],
        [0.74955698, 0.32282929, 0.68446368],
        [0.75030073, 0.32671432, 0.68988652],
        [0.75110533, 0.33073542, 0.69532641],
        [0.75180838, 0.33494874, 0.70065712],
        [0.75249526, 0.33932833, 0.70596023],
        [0.75316594, 0.34386911, 0.71122981],
        [0.75380619, 0.34852962, 0.71645183],
        [0.75452067, 0.35334004, 0.72162536],
        [0.755148  , 0.35835524, 0.72663347],
        [0.75577791, 0.36356121, 0.73151457],
        [0.75639901, 0.36892699, 0.73618126],
        [0.75701024, 0.37444268, 0.74063708],
        [0.75762739, 0.38013853, 0.74489484],
        [0.75821804, 0.38593204, 0.74890568],
        [0.75881508, 0.39189343, 0.75269506],
        [0.75938566, 0.39794279, 0.75618468],
        [0.75999579, 0.40401037, 0.75948106],
        [0.76064084, 0.41008139, 0.76262316],
        [0.76126642, 0.4162382 , 0.76559918],
        [0.76194102, 0.42242083, 0.76847149],
        [0.76257301, 0.42863019, 0.77120762],
        [0.76323387, 0.43482153, 0.77374842],
        [0.76392159, 0.44099039, 0.77607511],
        [0.76465757, 0.44718199, 0.77812651],
        [0.76539937, 0.45331196, 0.77981563],
        [0.76618877, 0.45946436, 0.78112614],
        [0.76704541, 0.46549165, 0.78209761],
        [0.76789628, 0.47143616, 0.78273712],
        [0.76878126, 0.47737155, 0.78314564],
        [0.76980745, 0.4831456 , 0.78337889],
        [0.7708594 , 0.48889342, 0.78347887],
        [0.77197758, 0.49451831, 0.78345061],
        [0.77316118, 0.50002482, 0.78323061],
        [0.77441084, 0.50542127, 0.78272137],
        [0.77578746, 0.51065254, 0.78195637],
        [0.77724086, 0.51564289, 0.78080054],
        [0.77881435, 0.52047078, 0.77934362],
        [0.78054161, 0.52503989, 0.77760459],
        [0.78235165, 0.52939452, 0.77564014],
        [0.78432577, 0.53351593, 0.77357695],
        [0.7865662 , 0.53741474, 0.77167378],
        [0.78893375, 0.54116638, 0.77015094],
        [0.79166695, 0.54454665, 0.76923587],
        [0.7946409 , 0.54751298, 0.76897572],
        [0.79821134, 0.54929718, 0.76953429],
        [0.80188441, 0.54984231, 0.7717573 ],
        [0.80563328, 0.54945113, 0.77461147],
        [0.80922467, 0.54747532, 0.77756913],
        [0.81266908, 0.54467196, 0.780343  ],
        [0.81607888, 0.54165492, 0.78305226],
        [0.81950741, 0.53850482, 0.78575763],
        [0.82292154, 0.5353194 , 0.78841556],
        [0.8263216 , 0.53209876, 0.79102623],
        [0.82977017, 0.52879139, 0.79361169],
        [0.83320688, 0.52545241, 0.79611933],
        [0.83664421, 0.52194579, 0.79854808],
        [0.84002363, 0.51832917, 0.80082017],
        [0.84338469, 0.51450855, 0.80295161],
        [0.84677795, 0.51056546, 0.8050016 ],
        [0.85009286, 0.50646671, 0.80692884],
        [0.85341937, 0.50220368, 0.80877139],
        [0.85671769, 0.49786439, 0.81057733],
        [0.8599879 , 0.49344657, 0.81237367],
        [0.86325547, 0.48899594, 0.81414533],
        [0.86658427, 0.48445989, 0.81593921],
        [0.86991548, 0.48006955, 0.81772017],
        [0.87331249, 0.47577722, 0.81948467],
        [0.87686095, 0.47157509, 0.82126572],
        [0.88042854, 0.46756331, 0.82302121],
        [0.88407868, 0.46369394, 0.82475034],
        [0.88778652, 0.45992213, 0.82646663],
        [0.89159292, 0.45632916, 0.82821347],
        [0.89542963, 0.45296388, 0.82996856],
        [0.89924996, 0.44973705, 0.83175202],
        [0.90322583, 0.44663149, 0.83364342],
        [0.90713735, 0.44375464, 0.83554434],
        [0.91115878, 0.44091329, 0.83754263],
        [0.91517927, 0.43825123, 0.8395621 ],
        [0.91919744, 0.43576792, 0.84159906],
        [0.92330312, 0.43328116, 0.84368909],
        [0.92738448, 0.43093154, 0.84577824],
        [0.93144018, 0.42871696, 0.84787898],
        [0.9356018 , 0.42653955, 0.85004179],
        [0.9397168 , 0.42445639, 0.8521935 ],
        [0.94391683, 0.42236894, 0.85439632],
        [0.94805025, 0.42033568, 0.85656362],
        [0.95225008, 0.4182617 , 0.85872973],
        [0.95640394, 0.41628643, 0.86083523]]
    }

    def __init__(self, colors: np.ndarray):
        self.colors = np.array(colors)
        self.values = np.linspace(0.0, 1.0, num=len(self.colors))

    @classmethod
    def from_colormap(cls, colormap="parula_rgb"):
        if type(colormap) != str:
            raise exceptions.ArgumentError

        if colormap in Colormap.colormaps:
            colors = Colormap.colormaps[colormap]
            return cls(colors)
        else:
            raise exceptions.ArgumentError

    @classmethod
    def from_colors_list(cls, colors: np.ndarray):
        colors = np.array(colors)
        return cls(colors)

    def get_colormaps(self):
        return self.colormaps

    def __find_nearest_index_value(self, value):
        arr = self.values
        idx = np.abs(value - arr).argmin()       
        return idx    

    def __find_nearest_index_color(self, color: np.ndarray):
        assert color.ndim == 1
        assert color.shape[0] == 3        

        idx = np.linalg.norm(self.colors - color, axis=1).argmin()
        return idx

    def get_color(self, value):
        idx = self.__find_nearest_index_value(value)
        return self.colors[idx]

    def get_colors_from_values(self, array_of_values: np.ndarray):
        assert array_of_values.ndim == 2

        indexes = self.get_indexes_from_values(array_of_values)

        return self.get_colors_from_indexes(indexes)

    def get_colors_from_indexes(self, indexes: np.ndarray):
        assert indexes.ndim == 2

        return self.colors[indexes]

    def get_indexes_from_values(self, values: np.ndarray):
        assert values.ndim == 2
        
        return np.abs(values[:,:,None] - self.values).argmin(axis=2)

    def get_indexes_from_colors(self, colors: np.ndarray):
        assert colors.ndim == 3

        return np.linalg.norm(colors[:,:,None] - self.colors, axis=3).argmin(axis=2)

    def get_values_from_indexes(self, indexes: np.ndarray):
        return self.values[indexes]

    def get_values_from_colors(self, colors: np.ndarray):
        assert colors.ndim == 3

        indexes = self.get_indexes_from_colors(colors)

        return self.values[indexes]

    def get_inverse_color(self, color: np.ndarray):
        idx = self.__find_nearest_index_color(color)
        return self.colors[idx]

    def get_inverse_value(self, color: np.ndarray):
        idx = self.__find_nearest_index_color(color)
        return self.values[idx]

    def get_inverse_index(self, color: np.ndarray):
        idx = self.__find_nearest_index_color(color)
        return idx

    def get_index(self, value: float):
        idx = self.__find_nearest_index_value(value)
        return idx

    def get_colors_length(self):
        return len(self.colors)
    
class ColormapTorch:
    __colormaps = {
        "parula_rgb": [[0.2422, 0.1504, 0.6603],
[0.2444, 0.1534, 0.6728],
[0.2464, 0.1569, 0.6847],
[0.2484, 0.1607, 0.6961],
[0.2503, 0.1648, 0.7071],
[0.2522, 0.1689, 0.7179],
[0.254, 0.1732, 0.7286],
[0.2558, 0.1773, 0.7393],
[0.2576, 0.1814, 0.7501],
[0.2594, 0.1854, 0.761],
[0.2611, 0.1893, 0.7719],
[0.2628, 0.1932, 0.7828],
[0.2645, 0.1972, 0.7937],
[0.2661, 0.2011, 0.8043],
[0.2676, 0.2052, 0.8148],
[0.2691, 0.2094, 0.8249],
[0.2704, 0.2138, 0.8346],
[0.2717, 0.2184, 0.8439],
[0.2729, 0.2231, 0.8528],
[0.274, 0.228, 0.8612],
[0.2749, 0.233, 0.8692],
[0.2758, 0.2382, 0.8767],
[0.2766, 0.2435, 0.884],
[0.2774, 0.2489, 0.8908],
[0.2781, 0.2543, 0.8973],
[0.2788, 0.2598, 0.9035],
[0.2794, 0.2653, 0.9094],
[0.2798, 0.2708, 0.915],
[0.2802, 0.2764, 0.9204],
[0.2806, 0.2819, 0.9255],
[0.2809, 0.2875, 0.9305],
[0.2811, 0.293, 0.9352],
[0.2813, 0.2985, 0.9397],
[0.2814, 0.304, 0.9441],
[0.2814, 0.3095, 0.9483],
[0.2813, 0.315, 0.9524],
[0.2811, 0.3204, 0.9563],
[0.2809, 0.3259, 0.96],
[0.2807, 0.3313, 0.9636],
[0.2803, 0.3367, 0.967],
[0.2798, 0.3421, 0.9702],
[0.2791, 0.3475, 0.9733],
[0.2784, 0.3529, 0.9763],
[0.2776, 0.3583, 0.9791],
[0.2766, 0.3638, 0.9817],
[0.2754, 0.3693, 0.984],
[0.2741, 0.3748, 0.9862],
[0.2726, 0.3804, 0.9881],
[0.271, 0.386, 0.9898],
[0.2691, 0.3916, 0.9912],
[0.267, 0.3973, 0.9924],
[0.2647, 0.403, 0.9935],
[0.2621, 0.4088, 0.9946],
[0.2591, 0.4145, 0.9955],
[0.2556, 0.4203, 0.9965],
[0.2517, 0.4261, 0.9974],
[0.2473, 0.4319, 0.9983],
[0.2424, 0.4378, 0.9991],
[0.2369, 0.4437, 0.9996],
[0.2311, 0.4497, 0.9995],
[0.225, 0.4559, 0.9985],
[0.2189, 0.462, 0.9968],
[0.2128, 0.4682, 0.9948],
[0.2066, 0.4743, 0.9926],
[0.2006, 0.4803, 0.9906],
[0.195, 0.4861, 0.9887],
[0.1903, 0.4919, 0.9867],
[0.1869, 0.4975, 0.9844],
[0.1847, 0.503, 0.9819],
[0.1831, 0.5084, 0.9793],
[0.1818, 0.5138, 0.9766],
[0.1806, 0.5191, 0.9738],
[0.1795, 0.5244, 0.9709],
[0.1785, 0.5296, 0.9677],
[0.1778, 0.5349, 0.9641],
[0.1773, 0.5401, 0.9602],
[0.1768, 0.5452, 0.956],
[0.1764, 0.5504, 0.9516],
[0.1755, 0.5554, 0.9473],
[0.174, 0.5605, 0.9432],
[0.1716, 0.5655, 0.9393],
[0.1686, 0.5705, 0.9357],
[0.1649, 0.5755, 0.9323],
[0.161, 0.5805, 0.9289],
[0.1573, 0.5854, 0.9254],
[0.154, 0.5902, 0.9218],
[0.1513, 0.595, 0.9182],
[0.1492, 0.5997, 0.9147],
[0.1475, 0.6043, 0.9113],
[0.1461, 0.6089, 0.908],
[0.1446, 0.6135, 0.905],
[0.1429, 0.618, 0.9022],
[0.1408, 0.6226, 0.8998],
[0.1383, 0.6272, 0.8975],
[0.1354, 0.6317, 0.8953],
[0.1321, 0.6363, 0.8932],
[0.1288, 0.6408, 0.891],
[0.1253, 0.6453, 0.8887],
[0.1219, 0.6497, 0.8862],
[0.1185, 0.6541, 0.8834],
[0.1152, 0.6584, 0.8804],
[0.1119, 0.6627, 0.877],
[0.1085, 0.6669, 0.8734],
[0.1048, 0.671, 0.8695],
[0.1009, 0.675, 0.8653],
[0.0964, 0.6789, 0.8609],
[0.0914, 0.6828, 0.8562],
[0.0855, 0.6865, 0.8513],
[0.0789, 0.6902, 0.8462],
[0.0713, 0.6938, 0.8409],
[0.0628, 0.6972, 0.8355],
[0.0535, 0.7006, 0.8299],
[0.0433, 0.7039, 0.8242],
[0.0328, 0.7071, 0.8183],
[0.0234, 0.7103, 0.8124],
[0.0155, 0.7133, 0.8064],
[0.0091, 0.7163, 0.8003],
[0.0046, 0.7192, 0.7941],
[0.0019, 0.722, 0.7878],
[0.0009, 0.7248, 0.7815],
[0.0018, 0.7275, 0.7752],
[0.0046, 0.7301, 0.7688],
[0.0094, 0.7327, 0.7623],
[0.0162, 0.7352, 0.7558],
[0.0253, 0.7376, 0.7492],
[0.0369, 0.74, 0.7426],
[0.0504, 0.7423, 0.7359],
[0.0638, 0.7446, 0.7292],
[0.077, 0.7468, 0.7224],
[0.0899, 0.7489, 0.7156],
[0.1023, 0.751, 0.7088],
[0.1141, 0.7531, 0.7019],
[0.1252, 0.7552, 0.695],
[0.1354, 0.7572, 0.6881],
[0.1448, 0.7593, 0.6812],
[0.1532, 0.7614, 0.6741],
[0.1609, 0.7635, 0.6671],
[0.1678, 0.7656, 0.6599],
[0.1741, 0.7678, 0.6527],
[0.1799, 0.7699, 0.6454],
[0.1853, 0.7721, 0.6379],
[0.1905, 0.7743, 0.6303],
[0.1954, 0.7765, 0.6225],
[0.2003, 0.7787, 0.6146],
[0.2061, 0.7808, 0.6065],
[0.2118, 0.7828, 0.5983],
[0.2178, 0.7849, 0.5899],
[0.2244, 0.7869, 0.5813],
[0.2318, 0.7887, 0.5725],
[0.2401, 0.7905, 0.5636],
[0.2491, 0.7922, 0.5546],
[0.2589, 0.7937, 0.5454],
[0.2695, 0.7951, 0.536],
[0.2809, 0.7964, 0.5266],
[0.2929, 0.7975, 0.517],
[0.3052, 0.7985, 0.5074],
[0.3176, 0.7994, 0.4975],
[0.3301, 0.8002, 0.4876],
[0.3424, 0.8009, 0.4774],
[0.3548, 0.8016, 0.4669],
[0.3671, 0.8021, 0.4563],
[0.3795, 0.8026, 0.4454],
[0.3921, 0.8029, 0.4344],
[0.405, 0.8031, 0.4233],
[0.4184, 0.803, 0.4122],
[0.4322, 0.8028, 0.4013],
[0.4463, 0.8024, 0.3904],
[0.4608, 0.8018, 0.3797],
[0.4753, 0.8011, 0.3691],
[0.4899, 0.8002, 0.3586],
[0.5044, 0.7993, 0.348],
[0.5187, 0.7982, 0.3374],
[0.5329, 0.797, 0.3267],
[0.547, 0.7957, 0.3159],
[0.5609, 0.7943, 0.305],
[0.5748, 0.7929, 0.2941],
[0.5886, 0.7913, 0.2833],
[0.6024, 0.7896, 0.2726],
[0.6161, 0.7878, 0.2622],
[0.6297, 0.7859, 0.2521],
[0.6433, 0.7839, 0.2423],
[0.6567, 0.7818, 0.2329],
[0.6701, 0.7796, 0.2239],
[0.6833, 0.7773, 0.2155],
[0.6963, 0.775, 0.2075],
[0.7091, 0.7727, 0.1998],
[0.7218, 0.7703, 0.1924],
[0.7344, 0.7679, 0.1852],
[0.7468, 0.7654, 0.1782],
[0.759, 0.7629, 0.1717],
[0.771, 0.7604, 0.1658],
[0.7829, 0.7579, 0.1608],
[0.7945, 0.7554, 0.157],
[0.806, 0.7529, 0.1546],
[0.8172, 0.7505, 0.1535],
[0.8281, 0.7481, 0.1536],
[0.8389, 0.7457, 0.1546],
[0.8495, 0.7435, 0.1564],
[0.86, 0.7413, 0.1587],
[0.8703, 0.7392, 0.1615],
[0.8804, 0.7372, 0.165],
[0.8903, 0.7353, 0.1695],
[0.9, 0.7336, 0.1749],
[0.9093, 0.7321, 0.1815],
[0.9184, 0.7308, 0.189],
[0.9272, 0.7298, 0.1973],
[0.9357, 0.729, 0.2061],
[0.944, 0.7285, 0.2151],
[0.9523, 0.7284, 0.2237],
[0.9606, 0.7285, 0.2312],
[0.9689, 0.7292, 0.2373],
[0.977, 0.7304, 0.2418],
[0.9842, 0.733, 0.2446],
[0.99, 0.7365, 0.2429],
[0.9946, 0.7407, 0.2394],
[0.9966, 0.7458, 0.2351],
[0.9971, 0.7513, 0.2309],
[0.9972, 0.7569, 0.2267],
[0.9971, 0.7626, 0.2224],
[0.9969, 0.7683, 0.2181],
[0.9966, 0.774, 0.2138],
[0.9962, 0.7798, 0.2095],
[0.9957, 0.7856, 0.2053],
[0.9949, 0.7915, 0.2012],
[0.9938, 0.7974, 0.1974],
[0.9923, 0.8034, 0.1939],
[0.9906, 0.8095, 0.1906],
[0.9885, 0.8156, 0.1875],
[0.9861, 0.8218, 0.1846],
[0.9835, 0.828, 0.1817],
[0.9807, 0.8342, 0.1787],
[0.9778, 0.8404, 0.1757],
[0.9748, 0.8467, 0.1726],
[0.972, 0.8529, 0.1695],
[0.9694, 0.8591, 0.1665],
[0.9671, 0.8654, 0.1636],
[0.9651, 0.8716, 0.1608],
[0.9634, 0.8778, 0.1582],
[0.9619, 0.884, 0.1557],
[0.9608, 0.8902, 0.1532],
[0.9601, 0.8963, 0.1507],
[0.9596, 0.9023, 0.148],
[0.9595, 0.9084, 0.145],
[0.9597, 0.9143, 0.1418],
[0.9601, 0.9203, 0.1382],
[0.9608, 0.9262, 0.1344],
[0.9618, 0.932, 0.1304],
[0.9629, 0.9379, 0.1261],
[0.9642, 0.9437, 0.1216],
[0.9657, 0.9494, 0.1168],
[0.9674, 0.9552, 0.1116],
[0.9692, 0.9609, 0.1061],
[0.9711, 0.9667, 0.1001],
[0.973, 0.9724, 0.0938],
[0.9749, 0.9782, 0.0872],
[0.9769, 0.9839, 0.0805]],
        "parula_lab": [[ 2.74782051e+01,  4.68630472e+01, -6.55028698e+01],
       [ 2.79912715e+01,  4.75048912e+01, -6.65738490e+01],
       [ 2.85059096e+01,  4.80291747e+01, -6.75441553e+01],
       [ 2.90202195e+01,  4.84754507e+01, -6.84329968e+01],
       [ 2.95347980e+01,  4.88483700e+01, -6.92554426e+01],
       [ 3.00435716e+01,  4.92049454e+01, -7.00523394e+01],
       [ 3.05562309e+01,  4.95239923e+01, -7.08232077e+01],
       [ 3.10592327e+01,  4.98682542e+01, -7.16055752e+01],
       [ 3.15642651e+01,  5.02194982e+01, -7.23952501e+01],
       [ 3.20666714e+01,  5.05909231e+01, -7.31998643e+01],
       [ 3.25618366e+01,  5.09721347e+01, -7.40121119e+01],
       [ 3.30563853e+01,  5.13527823e+01, -7.48210657e+01],
       [ 3.35549544e+01,  5.17196702e+01, -7.56191431e+01],
       [ 3.40386653e+01,  5.20731536e+01, -7.63931563e+01],
       [ 3.45267138e+01,  5.23891788e+01, -7.71413972e+01],
       [ 3.50087812e+01,  5.26600940e+01, -7.78367372e+01],
       [ 3.54860322e+01,  5.28671646e+01, -7.84778406e+01],
       [ 3.59624244e+01,  5.30152793e+01, -7.90584881e+01],
       [ 3.64316521e+01,  5.31148380e+01, -7.95895544e+01],
       [ 3.68962497e+01,  5.31441432e+01, -8.00526146e+01],
       [ 3.73525453e+01,  5.31214697e+01, -8.04688291e+01],
       [ 3.78067048e+01,  5.30300131e+01, -8.08136697e+01],
       [ 3.82599113e+01,  5.29040660e+01, -8.11292970e+01],
       [ 3.87067048e+01,  5.27219878e+01, -8.13812221e+01],
       [ 3.91456074e+01,  5.25106027e+01, -8.16013025e+01],
       [ 3.95834293e+01,  5.22583992e+01, -8.17784587e+01],
       [ 4.00136955e+01,  5.19764892e+01, -8.19236060e+01],
       [ 4.04349673e+01,  5.16620945e+01, -8.20393447e+01],
       [ 4.08581249e+01,  5.13142405e+01, -8.21222474e+01],
       [ 4.12705470e+01,  5.09532306e+01, -8.21787879e+01],
       [ 4.16858601e+01,  5.05640512e+01, -8.22155429e+01],
       [ 4.20889913e+01,  5.01590954e+01, -8.22285995e+01],
       [ 4.24890939e+01,  4.97348433e+01, -8.22173492e+01],
       [ 4.28870244e+01,  4.92968755e+01, -8.21948784e+01],
       [ 4.32805644e+01,  4.88369095e+01, -8.21505416e+01],
       [ 4.36720605e+01,  4.83632779e+01, -8.20948866e+01],
       [ 4.40538035e+01,  4.78825287e+01, -8.20263058e+01],
       [ 4.44382867e+01,  4.73676667e+01, -8.19243072e+01],
       [ 4.48166602e+01,  4.68569910e+01, -8.18177780e+01],
       [ 4.51895579e+01,  4.63216446e+01, -8.16915430e+01],
       [ 4.55584670e+01,  4.57643497e+01, -8.15431757e+01],
       [ 4.59243230e+01,  4.51908436e+01, -8.13855021e+01],
       [ 4.62898201e+01,  4.46067552e+01, -8.12140346e+01],
       [ 4.66515604e+01,  4.40007515e+01, -8.10201997e+01],
       [ 4.70142362e+01,  4.33546672e+01, -8.07964210e+01],
       [ 4.73701575e+01,  4.26750420e+01, -8.05411436e+01],
       [ 4.77248800e+01,  4.19819978e+01, -8.02736884e+01],
       [ 4.80791350e+01,  4.12398499e+01, -7.99645630e+01],
       [ 4.84304511e+01,  4.04754888e+01, -7.96320114e+01],
       [ 4.87746171e+01,  3.96745281e+01, -7.92688823e+01],
       [ 4.91211379e+01,  3.88329455e+01, -7.88738171e+01],
       [ 4.94661448e+01,  3.79752271e+01, -7.84673312e+01],
       [ 4.98168142e+01,  3.70920238e+01, -7.80519243e+01],
       [ 5.01560221e+01,  3.61943633e+01, -7.76272929e+01],
       [ 5.05012435e+01,  3.52753270e+01, -7.72074060e+01],
       [ 5.08437463e+01,  3.43359732e+01, -7.67781751e+01],
       [ 5.11847448e+01,  3.33832029e+01, -7.63517895e+01],
       [ 5.15291081e+01,  3.23928908e+01, -7.59061953e+01],
       [ 5.18663245e+01,  3.13607225e+01, -7.54303316e+01],
       [ 5.22006088e+01,  3.02516936e+01, -7.48749422e+01],
       [ 5.25336777e+01,  2.90222659e+01, -7.41950151e+01],
       [ 5.28527788e+01,  2.77456959e+01, -7.34394133e+01],
       [ 5.31784056e+01,  2.64271864e+01, -7.26312705e+01],
       [ 5.34984128e+01,  2.51056990e+01, -7.18044437e+01],
       [ 5.38217885e+01,  2.38261475e+01, -7.10006363e+01],
       [ 5.41408580e+01,  2.25998283e+01, -7.02181279e+01],
       [ 5.44683596e+01,  2.13870697e+01, -6.94079731e+01],
       [ 5.47891590e+01,  2.02085953e+01, -6.85663879e+01],
       [ 5.51103116e+01,  1.90549873e+01, -6.76961092e+01],
       [ 5.54292181e+01,  1.79223885e+01, -6.68156270e+01],
       [ 5.57506938e+01,  1.67886032e+01, -6.59172748e+01],
       [ 5.60665101e+01,  1.56651725e+01, -6.50143860e+01],
       [ 5.63835393e+01,  1.45365527e+01, -6.40958880e+01],
       [ 5.66916569e+01,  1.33996256e+01, -6.31498957e+01],
       [ 5.70045694e+01,  1.22183171e+01, -6.21402150e+01],
       [ 5.73093013e+01,  1.10313864e+01, -6.11018050e+01],
       [ 5.76047502e+01,  9.83462789e+00, -6.00364521e+01],
       [ 5.79072260e+01,  8.60907482e+00, -5.89320594e+01],
       [ 5.81964856e+01,  7.41610210e+00, -5.78635058e+01],
       [ 5.84947799e+01,  6.21684797e+00, -5.68093277e+01],
       [ 5.87862175e+01,  5.03550682e+00, -5.57950379e+01],
       [ 5.90810168e+01,  3.87326383e+00, -5.48183299e+01],
       [ 5.93773457e+01,  2.71919251e+00, -5.38680742e+01],
       [ 5.96750484e+01,  1.56596846e+00, -5.29161859e+01],
       [ 5.99673832e+01,  4.27862134e-01, -5.19591821e+01],
       [ 6.02550899e+01, -6.91275646e-01, -5.09958211e+01],
       [ 6.05474573e+01, -1.79331182e+00, -5.00254102e+01],
       [ 6.08381705e+01, -2.85454176e+00, -4.90720850e+01],
       [ 6.11260784e+01, -3.87939756e+00, -4.81377252e+01],
       [ 6.14179239e+01, -4.88476919e+00, -4.72116978e+01],
       [ 6.17144208e+01, -5.86010070e+00, -4.63211870e+01],
       [ 6.20063922e+01, -6.80217126e+00, -4.54666163e+01],
       [ 6.23102292e+01, -7.72539846e+00, -4.46503527e+01],
       [ 6.26148529e+01, -8.64263287e+00, -4.38476148e+01],
       [ 6.29128622e+01, -9.53929859e+00, -4.30700308e+01],
       [ 6.32192090e+01, -1.04435238e+01, -4.22940783e+01],
       [ 6.35181075e+01, -1.13375547e+01, -4.15163210e+01],
       [ 6.38163511e+01, -1.22389276e+01, -4.07261453e+01],
       [ 6.41063494e+01, -1.31373083e+01, -3.99213208e+01],
       [ 6.43941573e+01, -1.40573088e+01, -3.90783435e+01],
       [ 6.46737494e+01, -1.49742725e+01, -3.82206814e+01],
       [ 6.49501584e+01, -1.59214097e+01, -3.73124035e+01],
       [ 6.52178532e+01, -1.68683718e+01, -3.63902633e+01],
       [ 6.54752689e+01, -1.78267992e+01, -3.54426746e+01],
       [ 6.57228121e+01, -1.87947342e+01, -3.44689543e+01],
       [ 6.59606513e+01, -1.97684844e+01, -3.34829241e+01],
       [ 6.61958064e+01, -2.07677894e+01, -3.24596074e+01],
       [ 6.64134698e+01, -2.17612348e+01, -3.14360224e+01],
       [ 6.66296340e+01, -2.27711100e+01, -3.03873141e+01],
       [ 6.68364518e+01, -2.37857479e+01, -2.93256308e+01],
       [ 6.70279067e+01, -2.47800265e+01, -2.82741815e+01],
       [ 6.72188771e+01, -2.57851484e+01, -2.71959278e+01],
       [ 6.74029502e+01, -2.67779861e+01, -2.61147477e+01],
       [ 6.75798983e+01, -2.77625701e+01, -2.50168765e+01],
       [ 6.77595381e+01, -2.87328892e+01, -2.39153003e+01],
       [ 6.79258562e+01, -2.96699279e+01, -2.28204675e+01],
       [ 6.80942253e+01, -3.05986153e+01, -2.17088655e+01],
       [ 6.82573981e+01, -3.15032315e+01, -2.05915273e+01],
       [ 6.84152196e+01, -3.23843525e+01, -1.94686893e+01],
       [ 6.85761530e+01, -3.32465701e+01, -1.83415388e+01],
       [ 6.87326407e+01, -3.40760790e+01, -1.72215455e+01],
       [ 6.88837798e+01, -3.48808959e+01, -1.60960547e+01],
       [ 6.90374395e+01, -3.56719607e+01, -1.49531898e+01],
       [ 6.91866497e+01, -3.64291847e+01, -1.38175032e+01],
       [ 6.93309027e+01, -3.71580772e+01, -1.26757159e+01],
       [ 6.94789961e+01, -3.78608112e+01, -1.15286266e+01],
       [ 6.96226811e+01, -3.85307821e+01, -1.03746057e+01],
       [ 6.97703172e+01, -3.91729692e+01, -9.21520693e+00],
       [ 6.99132341e+01, -3.97836874e+01, -8.04943355e+00],
       [ 7.00519357e+01, -4.03568502e+01, -6.89054456e+00],
       [ 7.01936109e+01, -4.09077888e+01, -5.72796861e+00],
       [ 7.03369693e+01, -4.14473473e+01, -4.54980044e+00],
       [ 7.04820801e+01, -4.19725192e+01, -3.37005761e+00],
       [ 7.06200529e+01, -4.24793726e+01, -2.20199392e+00],
       [ 7.07662892e+01, -4.29918518e+01, -1.02307490e+00],
       [ 7.09104560e+01, -4.35205786e+01,  1.79127516e-01],
       [ 7.10551461e+01, -4.40409809e+01,  1.36662521e+00],
       [ 7.11976403e+01, -4.45785707e+01,  2.57698339e+00],
       [ 7.13475315e+01, -4.51276234e+01,  3.79623914e+00],
       [ 7.14886720e+01, -4.56719413e+01,  5.01478113e+00],
       [ 7.16363627e+01, -4.62378020e+01,  6.26842691e+00],
       [ 7.17841413e+01, -4.68025152e+01,  7.53388013e+00],
       [ 7.19309332e+01, -4.73756705e+01,  8.82314960e+00],
       [ 7.20786172e+01, -4.79416949e+01,  1.01250540e+01],
       [ 7.22229040e+01, -4.84660764e+01,  1.14476160e+01],
       [ 7.23600306e+01, -4.89738384e+01,  1.27709723e+01],
       [ 7.25070668e+01, -4.94775267e+01,  1.41329251e+01],
       [ 7.26499796e+01, -4.99437840e+01,  1.55135728e+01],
       [ 7.27822685e+01, -5.03520717e+01,  1.69037800e+01],
       [ 7.29211541e+01, -5.07096179e+01,  1.83137609e+01],
       [ 7.30582209e+01, -5.10099667e+01,  1.97313967e+01],
       [ 7.31861940e+01, -5.12401878e+01,  2.11600983e+01],
       [ 7.33135691e+01, -5.14054533e+01,  2.26112475e+01],
       [ 7.34419792e+01, -5.14903499e+01,  2.40598384e+01],
       [ 7.35620591e+01, -5.14993787e+01,  2.55195888e+01],
       [ 7.36810884e+01, -5.14439054e+01,  2.69729693e+01],
       [ 7.37966425e+01, -5.13465621e+01,  2.84559649e+01],
       [ 7.39102088e+01, -5.11921732e+01,  2.99302064e+01],
       [ 7.40183319e+01, -5.10107119e+01,  3.14296910e+01],
       [ 7.41312185e+01, -5.07945781e+01,  3.29671405e+01],
       [ 7.42325801e+01, -5.05261745e+01,  3.44939915e+01],
       [ 7.43389921e+01, -5.02213425e+01,  3.60569597e+01],
       [ 7.44368073e+01, -4.98437678e+01,  3.76118365e+01],
       [ 7.45350451e+01, -4.93953954e+01,  3.91694834e+01],
       [ 7.46210013e+01, -4.88356464e+01,  4.07010470e+01],
       [ 7.47103995e+01, -4.81829383e+01,  4.22006813e+01],
       [ 7.47943275e+01, -4.74395140e+01,  4.36818160e+01],
       [ 7.48749982e+01, -4.65898201e+01,  4.51226341e+01],
       [ 7.49556977e+01, -4.56785322e+01,  4.65382396e+01],
       [ 7.50300726e+01, -4.46878494e+01,  4.79210618e+01],
       [ 7.51105327e+01, -4.36624678e+01,  4.93082351e+01],
       [ 7.51808382e+01, -4.25880703e+01,  5.06675665e+01],
       [ 7.52495261e+01, -4.14712764e+01,  5.20198574e+01],
       [ 7.53165937e+01, -4.03133780e+01,  5.33636010e+01],
       [ 7.53806193e+01, -3.91249469e+01,  5.46952159e+01],
       [ 7.54520668e+01, -3.78982886e+01,  5.60144669e+01],
       [ 7.55148000e+01, -3.66194146e+01,  5.72915346e+01],
       [ 7.55777911e+01, -3.52918906e+01,  5.85362141e+01],
       [ 7.56399011e+01, -3.39236165e+01,  5.97262211e+01],
       [ 7.57010243e+01, -3.25171174e+01,  6.08624551e+01],
       [ 7.57627388e+01, -3.10646760e+01,  6.19481833e+01],
       [ 7.58218037e+01, -2.95873304e+01,  6.29709489e+01],
       [ 7.58815079e+01, -2.80671759e+01,  6.39372414e+01],
       [ 7.59385661e+01, -2.65245897e+01,  6.48270944e+01],
       [ 7.59995786e+01, -2.49773564e+01,  6.56676691e+01],
       [ 7.60640841e+01, -2.34292457e+01,  6.64689058e+01],
       [ 7.61266420e+01, -2.18592579e+01,  6.72277898e+01],
       [ 7.61941020e+01, -2.02826881e+01,  6.79602295e+01],
       [ 7.62573015e+01, -1.86993009e+01,  6.86579434e+01],
       [ 7.63233875e+01, -1.71205105e+01,  6.93058465e+01],
       [ 7.63921588e+01, -1.55474511e+01,  6.98991534e+01],
       [ 7.64657566e+01, -1.39685919e+01,  7.04222596e+01],
       [ 7.65399369e+01, -1.24054500e+01,  7.08529851e+01],
       [ 7.66188767e+01, -1.08365887e+01,  7.11871658e+01],
       [ 7.67045413e+01, -9.29963026e+00,  7.14348902e+01],
       [ 7.67896277e+01, -7.78378041e+00,  7.15979652e+01],
       [ 7.68781264e+01, -6.27025601e+00,  7.17021388e+01],
       [ 7.69807451e+01, -4.79787208e+00,  7.17616181e+01],
       [ 7.70859403e+01, -3.33217699e+00,  7.17871115e+01],
       [ 7.71977581e+01, -1.89783022e+00,  7.17799065e+01],
       [ 7.73161181e+01, -4.93670748e-01,  7.17238055e+01],
       [ 7.74410838e+01,  8.82423848e-01,  7.15939506e+01],
       [ 7.75787459e+01,  2.21639801e+00,  7.13988749e+01],
       [ 7.77240863e+01,  3.48893581e+00,  7.11041382e+01],
       [ 7.78814349e+01,  4.72004773e+00,  7.07326220e+01],
       [ 7.80541612e+01,  5.88517239e+00,  7.02891694e+01],
       [ 7.82351652e+01,  6.99560169e+00,  6.97882357e+01],
       [ 7.84325771e+01,  8.04656337e+00,  6.92621215e+01],
       [ 7.86566202e+01,  9.04075875e+00,  6.87768135e+01],
       [ 7.88933754e+01,  9.99742651e+00,  6.83884909e+01],
       [ 7.91666950e+01,  1.08593950e+01,  6.81551468e+01],
       [ 7.94640895e+01,  1.16158100e+01,  6.80888086e+01],
       [ 7.98211337e+01,  1.20707803e+01,  6.82312449e+01],
       [ 8.01884409e+01,  1.22097883e+01,  6.87981109e+01],
       [ 8.05633277e+01,  1.21100374e+01,  6.95259252e+01],
       [ 8.09224668e+01,  1.16062064e+01,  7.02801285e+01],
       [ 8.12669082e+01,  1.08913491e+01,  7.09874660e+01],
       [ 8.16078882e+01,  1.01220046e+01,  7.16783269e+01],
       [ 8.19507411e+01,  9.31872968e+00,  7.23681953e+01],
       [ 8.22921544e+01,  8.50644698e+00,  7.30459676e+01],
       [ 8.26321604e+01,  7.68518261e+00,  7.37116885e+01],
       [ 8.29770172e+01,  6.84180463e+00,  7.43709808e+01],
       [ 8.33206880e+01,  5.99036374e+00,  7.50104290e+01],
       [ 8.36644205e+01,  5.09617605e+00,  7.56297603e+01],
       [ 8.40023632e+01,  4.17393823e+00,  7.62091428e+01],
       [ 8.43384690e+01,  3.19968023e+00,  7.67526602e+01],
       [ 8.46777948e+01,  2.19419333e+00,  7.72754084e+01],
       [ 8.50092863e+01,  1.14901204e+00,  7.77668539e+01],
       [ 8.53419371e+01,  6.19392736e-02,  7.82367055e+01],
       [ 8.56717689e+01, -1.04458081e+00,  7.86972190e+01],
       [ 8.59987900e+01, -2.17112483e+00,  7.91552866e+01],
       [ 8.63255466e+01, -3.30603567e+00,  7.96070593e+01],
       [ 8.66584268e+01, -4.46272687e+00,  8.00644993e+01],
       [ 8.69915483e+01, -5.58226474e+00,  8.05186425e+01],
       [ 8.73312492e+01, -6.67680931e+00,  8.09685912e+01],
       [ 8.76860945e+01, -7.74835092e+00,  8.14227584e+01],
       [ 8.80428538e+01, -8.77135535e+00,  8.18704096e+01],
       [ 8.84078679e+01, -9.75804553e+00,  8.23113374e+01],
       [ 8.87786523e+01, -1.07198579e+01,  8.27489915e+01],
       [ 8.91592924e+01, -1.16360634e+01,  8.31944344e+01],
       [ 8.95429625e+01, -1.24942106e+01,  8.36419816e+01],
       [ 8.99249956e+01, -1.33170522e+01,  8.40967648e+01],
       [ 9.03225835e+01, -1.41089692e+01,  8.45790719e+01],
       [ 9.07137353e+01, -1.48425674e+01,  8.50638074e+01],
       [ 9.11158779e+01, -1.55671107e+01,  8.55733716e+01],
       [ 9.15179268e+01, -1.62459353e+01,  8.60883351e+01],
       [ 9.19197436e+01, -1.68791802e+01,  8.66077609e+01],
       [ 9.23303117e+01, -1.75133042e+01,  8.71407181e+01],
       [ 9.27384477e+01, -1.81124564e+01,  8.76734524e+01],
       [ 9.31440180e+01, -1.86771744e+01,  8.82091389e+01],
       [ 9.35601803e+01, -1.92324154e+01,  8.87606572e+01],
       [ 9.39716802e+01, -1.97636198e+01,  8.93093417e+01],
       [ 9.43916825e+01, -2.02959198e+01,  8.98710622e+01],
       [ 9.48050246e+01, -2.08144025e+01,  9.04237225e+01],
       [ 9.52250076e+01, -2.13432673e+01,  9.09760800e+01],
       [ 9.56403944e+01, -2.18469594e+01,  9.15129846e+01]],
        "parula_norm_lab": [[0.27478205, 0.68573744, 0.24508679],
        [0.27991271, 0.68825448, 0.24088687],
        [0.2850591 , 0.69031049, 0.23708174],
        [0.29020219, 0.69206059, 0.23359609],
        [0.29534798, 0.69352302, 0.23037081],
        [0.30043572, 0.69492135, 0.22724573],
        [0.30556231, 0.69617252, 0.22422271],
        [0.31059233, 0.69752257, 0.22115461],
        [0.31564265, 0.69889999, 0.21805784],
        [0.32066671, 0.70035656, 0.21490249],
        [0.32561837, 0.70185151, 0.21171721],
        [0.33056385, 0.70334424, 0.20854484],
        [0.33554954, 0.70478302, 0.20541513],
        [0.34038665, 0.70616923, 0.20237978],
        [0.34526714, 0.70740854, 0.1994455 ],
        [0.35008781, 0.70847096, 0.19671868],
        [0.35486032, 0.709283  , 0.19420455],
        [0.35962424, 0.70986384, 0.1919275 ],
        [0.36431652, 0.71025427, 0.18984488],
        [0.3689625 , 0.71036919, 0.18802896],
        [0.37352545, 0.71028027, 0.18639675],
        [0.37806705, 0.70992162, 0.18504443],
        [0.38259911, 0.70942771, 0.18380668],
        [0.38706705, 0.70871368, 0.18281874],
        [0.39145607, 0.70788472, 0.18195568],
        [0.39583429, 0.70689568, 0.18126095],
        [0.40013695, 0.70579015, 0.18069174],
        [0.40434967, 0.70455723, 0.18023786],
        [0.40858125, 0.7031931 , 0.17991276],
        [0.41270547, 0.70177737, 0.17969103],
        [0.4168586 , 0.70025118, 0.17954689],
        [0.42088991, 0.69866312, 0.17949569],
        [0.42489094, 0.69699939, 0.17953981],
        [0.42887024, 0.69528186, 0.17962793],
        [0.43280564, 0.69347808, 0.1798018 ],
        [0.4367206 , 0.6916207 , 0.18002005],
        [0.44053803, 0.68973541, 0.180289  ],
        [0.44438287, 0.68771634, 0.18068899],
        [0.4481666 , 0.68571369, 0.18110675],
        [0.45189558, 0.68361429, 0.18160179],
        [0.45558467, 0.68142882, 0.18218362],
        [0.45924323, 0.67917978, 0.18280195],
        [0.4628982 , 0.67688924, 0.18347437],
        [0.4665156 , 0.67451275, 0.18423451],
        [0.47014236, 0.67197909, 0.18511207],
        [0.47370157, 0.66931389, 0.18611316],
        [0.4772488 , 0.66659607, 0.18716201],
        [0.48079135, 0.66368569, 0.18837426],
        [0.48430451, 0.66068819, 0.18967839],
        [0.48774617, 0.65754717, 0.19110242],
        [0.49121138, 0.65424685, 0.1926517 ],
        [0.49466145, 0.65088324, 0.19424576],
        [0.49816814, 0.6474197 , 0.19587481],
        [0.50156022, 0.64389946, 0.19754003],
        [0.50501244, 0.6402954 , 0.19918664],
        [0.50843746, 0.63661166, 0.2008699 ],
        [0.51184745, 0.63287531, 0.202542  ],
        [0.51529108, 0.62899173, 0.20428943],
        [0.51866324, 0.62494401, 0.20615556],
        [0.52200609, 0.62059488, 0.20833356],
        [0.52533678, 0.61577359, 0.21099994],
        [0.52852779, 0.61076743, 0.21396309],
        [0.53178406, 0.60559681, 0.21713227],
        [0.53498413, 0.60041451, 0.22037473],
        [0.53821789, 0.59539666, 0.22352692],
        [0.54140858, 0.59058756, 0.22659558],
        [0.5446836 , 0.58583165, 0.22977265],
        [0.54789159, 0.58121018, 0.23307299],
        [0.55110312, 0.57668622, 0.23648585],
        [0.55429218, 0.57224466, 0.23993872],
        [0.55750694, 0.56779844, 0.24346167],
        [0.5606651 , 0.56339283, 0.24700241],
        [0.56383539, 0.55896687, 0.25060436],
        [0.56691657, 0.55450834, 0.25431413],
        [0.57004569, 0.54987575, 0.25827367],
        [0.57309301, 0.54522112, 0.26234586],
        [0.5760475 , 0.54052795, 0.26652372],
        [0.57907226, 0.53572186, 0.27085467],
        [0.58196486, 0.53104354, 0.27504508],
        [0.5849478 , 0.52634058, 0.27917911],
        [0.58786218, 0.52170787, 0.28315671],
        [0.59081017, 0.51715005, 0.28698694],
        [0.59377346, 0.51262428, 0.29071343],
        [0.59675048, 0.50810184, 0.29444633],
        [0.59967383, 0.50363868, 0.29819929],
        [0.6025509 , 0.4992499 , 0.30197717],
        [0.60547457, 0.49492819, 0.30578271],
        [0.6083817 , 0.4907665 , 0.30952124],
        [0.61126078, 0.48674746, 0.31318539],
        [0.61417924, 0.48280483, 0.31681687],
        [0.61714421, 0.47898   , 0.32030907],
        [0.62006392, 0.4752856 , 0.32366033],
        [0.62310229, 0.4716651 , 0.32686136],
        [0.62614853, 0.46806811, 0.33000935],
        [0.62912862, 0.46455177, 0.3330587 ],
        [0.63219209, 0.46100579, 0.33610165],
        [0.63518107, 0.45749979, 0.33915168],
        [0.63816351, 0.45396499, 0.34225041],
        [0.64106349, 0.45044193, 0.34540659],
        [0.64394157, 0.44683408, 0.34871238],
        [0.64673749, 0.44323815, 0.35207576],
        [0.64950158, 0.43952388, 0.35563763],
        [0.65217853, 0.43581031, 0.35925387],
        [0.65475269, 0.43205177, 0.3629699 ],
        [0.65722812, 0.42825594, 0.36678841],
        [0.65960651, 0.42443732, 0.3706552 ],
        [0.66195806, 0.42051847, 0.37466821],
        [0.6641347 , 0.41662261, 0.37868227],
        [0.66629634, 0.41266231, 0.38279485],
        [0.66836452, 0.40868334, 0.38695831],
        [0.67027907, 0.40478421, 0.39108164],
        [0.67218877, 0.40084256, 0.39531009],
        [0.6740295 , 0.39694907, 0.39955001],
        [0.67579898, 0.39308796, 0.40385539],
        [0.67759538, 0.38928279, 0.40817529],
        [0.67925856, 0.38560813, 0.41246875],
        [0.68094225, 0.38196621, 0.41682798],
        [0.68257398, 0.3784187 , 0.4212097 ],
        [0.6841522 , 0.37496332, 0.42561298],
        [0.68576153, 0.37158208, 0.43003318],
        [0.68732641, 0.3683291 , 0.43442531],
        [0.6888378 , 0.36517296, 0.438839  ],
        [0.6903744 , 0.36207074, 0.44332082],
        [0.6918665 , 0.35910124, 0.4477745 ],
        [0.69330903, 0.35624283, 0.45225209],
        [0.69478996, 0.35348701, 0.45675048],
        [0.69622681, 0.35085968, 0.46127606],
        [0.69770317, 0.3483413 , 0.46582272],
        [0.69913234, 0.34594632, 0.47039438],
        [0.70051936, 0.34369863, 0.47493904],
        [0.70193611, 0.34153808, 0.47949816],
        [0.70336969, 0.33942217, 0.48411843],
        [0.7048208 , 0.33736267, 0.48874487],
        [0.70620053, 0.33537501, 0.49332551],
        [0.70766289, 0.33336529, 0.49794873],
        [0.70910456, 0.33129185, 0.50266325],
        [0.71055146, 0.32925106, 0.5073201 ],
        [0.7119764 , 0.32714286, 0.5120666 ],
        [0.71347532, 0.32498971, 0.516848  ],
        [0.71488672, 0.32285513, 0.52162659],
        [0.71636363, 0.32063607, 0.52654285],
        [0.71784141, 0.31842151, 0.53150541],
        [0.71930933, 0.31617384, 0.53656137],
        [0.72078617, 0.31395414, 0.54166688],
        [0.72222904, 0.31189774, 0.5468534 ],
        [0.72360031, 0.30990652, 0.55204303],
        [0.72507067, 0.30793127, 0.55738402],
        [0.7264998 , 0.30610281, 0.56279832],
        [0.72782269, 0.30450168, 0.56825012],
        [0.72921154, 0.30309954, 0.57377945],
        [0.73058221, 0.3019217 , 0.57933881],
        [0.73186194, 0.30101887, 0.58494156],
        [0.73313569, 0.30037077, 0.59063234],
        [0.73441979, 0.30003784, 0.59631309],
        [0.73562059, 0.30000244, 0.6020376 ],
        [0.73681088, 0.30021998, 0.60773713],
        [0.73796643, 0.30060172, 0.6135528 ],
        [0.73910209, 0.30120716, 0.61933414],
        [0.74018332, 0.30191878, 0.62521447],
        [0.74131219, 0.30276636, 0.63124369],
        [0.7423258 , 0.30381892, 0.63723134],
        [0.74338992, 0.30501434, 0.64336063],
        [0.74436807, 0.30649503, 0.64945818],
        [0.74535045, 0.30825335, 0.6555666 ],
        [0.74621001, 0.31044845, 0.66157273],
        [0.74710399, 0.31300809, 0.66745365],
        [0.74794327, 0.31592347, 0.67326202],
        [0.74874998, 0.31925561, 0.67891229],
        [0.74955698, 0.32282929, 0.68446368],
        [0.75030073, 0.32671432, 0.68988652],
        [0.75110533, 0.33073542, 0.69532641],
        [0.75180838, 0.33494874, 0.70065712],
        [0.75249526, 0.33932833, 0.70596023],
        [0.75316594, 0.34386911, 0.71122981],
        [0.75380619, 0.34852962, 0.71645183],
        [0.75452067, 0.35334004, 0.72162536],
        [0.755148  , 0.35835524, 0.72663347],
        [0.75577791, 0.36356121, 0.73151457],
        [0.75639901, 0.36892699, 0.73618126],
        [0.75701024, 0.37444268, 0.74063708],
        [0.75762739, 0.38013853, 0.74489484],
        [0.75821804, 0.38593204, 0.74890568],
        [0.75881508, 0.39189343, 0.75269506],
        [0.75938566, 0.39794279, 0.75618468],
        [0.75999579, 0.40401037, 0.75948106],
        [0.76064084, 0.41008139, 0.76262316],
        [0.76126642, 0.4162382 , 0.76559918],
        [0.76194102, 0.42242083, 0.76847149],
        [0.76257301, 0.42863019, 0.77120762],
        [0.76323387, 0.43482153, 0.77374842],
        [0.76392159, 0.44099039, 0.77607511],
        [0.76465757, 0.44718199, 0.77812651],
        [0.76539937, 0.45331196, 0.77981563],
        [0.76618877, 0.45946436, 0.78112614],
        [0.76704541, 0.46549165, 0.78209761],
        [0.76789628, 0.47143616, 0.78273712],
        [0.76878126, 0.47737155, 0.78314564],
        [0.76980745, 0.4831456 , 0.78337889],
        [0.7708594 , 0.48889342, 0.78347887],
        [0.77197758, 0.49451831, 0.78345061],
        [0.77316118, 0.50002482, 0.78323061],
        [0.77441084, 0.50542127, 0.78272137],
        [0.77578746, 0.51065254, 0.78195637],
        [0.77724086, 0.51564289, 0.78080054],
        [0.77881435, 0.52047078, 0.77934362],
        [0.78054161, 0.52503989, 0.77760459],
        [0.78235165, 0.52939452, 0.77564014],
        [0.78432577, 0.53351593, 0.77357695],
        [0.7865662 , 0.53741474, 0.77167378],
        [0.78893375, 0.54116638, 0.77015094],
        [0.79166695, 0.54454665, 0.76923587],
        [0.7946409 , 0.54751298, 0.76897572],
        [0.79821134, 0.54929718, 0.76953429],
        [0.80188441, 0.54984231, 0.7717573 ],
        [0.80563328, 0.54945113, 0.77461147],
        [0.80922467, 0.54747532, 0.77756913],
        [0.81266908, 0.54467196, 0.780343  ],
        [0.81607888, 0.54165492, 0.78305226],
        [0.81950741, 0.53850482, 0.78575763],
        [0.82292154, 0.5353194 , 0.78841556],
        [0.8263216 , 0.53209876, 0.79102623],
        [0.82977017, 0.52879139, 0.79361169],
        [0.83320688, 0.52545241, 0.79611933],
        [0.83664421, 0.52194579, 0.79854808],
        [0.84002363, 0.51832917, 0.80082017],
        [0.84338469, 0.51450855, 0.80295161],
        [0.84677795, 0.51056546, 0.8050016 ],
        [0.85009286, 0.50646671, 0.80692884],
        [0.85341937, 0.50220368, 0.80877139],
        [0.85671769, 0.49786439, 0.81057733],
        [0.8599879 , 0.49344657, 0.81237367],
        [0.86325547, 0.48899594, 0.81414533],
        [0.86658427, 0.48445989, 0.81593921],
        [0.86991548, 0.48006955, 0.81772017],
        [0.87331249, 0.47577722, 0.81948467],
        [0.87686095, 0.47157509, 0.82126572],
        [0.88042854, 0.46756331, 0.82302121],
        [0.88407868, 0.46369394, 0.82475034],
        [0.88778652, 0.45992213, 0.82646663],
        [0.89159292, 0.45632916, 0.82821347],
        [0.89542963, 0.45296388, 0.82996856],
        [0.89924996, 0.44973705, 0.83175202],
        [0.90322583, 0.44663149, 0.83364342],
        [0.90713735, 0.44375464, 0.83554434],
        [0.91115878, 0.44091329, 0.83754263],
        [0.91517927, 0.43825123, 0.8395621 ],
        [0.91919744, 0.43576792, 0.84159906],
        [0.92330312, 0.43328116, 0.84368909],
        [0.92738448, 0.43093154, 0.84577824],
        [0.93144018, 0.42871696, 0.84787898],
        [0.9356018 , 0.42653955, 0.85004179],
        [0.9397168 , 0.42445639, 0.8521935 ],
        [0.94391683, 0.42236894, 0.85439632],
        [0.94805025, 0.42033568, 0.85656362],
        [0.95225008, 0.4182617 , 0.85872973],
        [0.95640394, 0.41628643, 0.86083523]]
    }

    def __init__(self, colors):
        self.colors = torch.from_numpy(np.array(colors))
        self.values = torch.linspace(0.0, 1.0, steps=len(colors))

    @classmethod
    def from_colormap(cls, colormap="parula_rgb"):
        if type(colormap) != str:
            raise exceptions.ArgumentError

        if colormap in ColormapTorch.__colormaps:
            colors = ColormapTorch.__colormaps[colormap]
            return cls(colors)
        else:
            raise exceptions.ArgumentError

    @classmethod
    def from_colors_list(cls, colors):
        return cls(colors)
    
    def to(self, device):
        self.colors = self.colors.to(device)
        self.values = self.values.to(device)
        return self

    def get_colormaps(self):
        return self.__colormaps

    def get_colors_from_values(self, tensor_of_values: torch.Tensor):
        assert len(tensor_of_values.shape) == 4
        assert tensor_of_values.shape[1] == 1

        indexes = self.get_indexes_from_values(tensor_of_values)
        
        return self.get_colors_from_indexes(indexes)

    def get_colors_from_indexes(self, indexes: torch.Tensor):
        assert len(indexes.shape) == 4
        assert indexes.shape[1] == 1

        return self.colors[indexes].squeeze(dim=1).permute((0,3,1,2))

    def get_indexes_from_values(self, values: torch.Tensor):
        assert len(values.shape) == 4
        assert values.shape[1] == 1

        return torch.abs(values.permute(0,2,3,1) - self.values).argmin(dim=-1, keepdim=True).permute(0,3,1,2)

    def get_indexes_from_colors(self, colors: torch.Tensor):
        assert len(colors.shape) == 4
        assert colors.shape[1] == 3

        return torch.linalg.norm(colors[None,:].permute(1,3,4,0,2) - self.colors, dim=-1).argmin(dim=-1, keepdim=True).permute(0,3,1,2)

    def get_values_from_indexes(self, indexes: torch.Tensor):
        
        assert len(indexes.shape) == 4
        assert indexes.shape[1] == 1

        return self.values[indexes]

    def get_values_from_colors(self, colors: torch.Tensor):
        assert len(colors.shape) == 4
        assert colors.shape[1] == 3

        indexes = self.get_indexes_from_colors(colors)

        return self.values[indexes]

    def get_colors_length(self):
        return len(self.colors)



if __name__ == "__main__":
    from timeit import default_timer as timer
    from tqdm import tqdm

    # LUT tests
    def generate_random_array_nxn(n):
        return np.random.uniform(low=0.0, high=1.0, size=(n,n))
    
    print("Testing numpy version: ")
    
    test_array_values = generate_random_array_nxn(4)

    print("test_array_values:\n", test_array_values)
    print()

    colormap = Colormap.from_colormap("parula_norm_lab")

    colors_from_values = colormap.get_colors_from_values(test_array_values)
    print("colors_from_values:\n", colors_from_values)
    print()

    indexes_from_values = colormap.get_indexes_from_values(test_array_values)
    print("indexes_from_values:\n", indexes_from_values)
    print()

    colors_from_indexes= colormap.get_colors_from_indexes(indexes_from_values)
    print("colors_from_indexes:\n", colors_from_indexes)
    print()

    values_from_indexes= colormap.get_values_from_indexes(indexes_from_values)
    print("values_from_indexes:\n", values_from_indexes)
    print()

    indexes_from_colors= colormap.get_indexes_from_colors(colors_from_values)
    print("indexes_from_colors:\n", indexes_from_colors)
    print()

    values_from_colors= colormap.get_values_from_colors(colors_from_values)
    print("values_from_colors:\n", values_from_colors)
    print()

    # Assertions
    assert (indexes_from_values==indexes_from_colors).all()
    assert (colors_from_values==colors_from_indexes).all()
    assert (values_from_indexes==values_from_colors).all()
    
    print("Testing PyTorch version...")

    torch.set_printoptions(precision=10)
    test_array_values_torch = torch.cat([torch.from_numpy(test_array_values)[None, None, :],torch.from_numpy(generate_random_array_nxn(4))[None, None, :]])

    print("test_array_values_torch:\n", test_array_values_torch)
    print("test_array_values_torch.shape:\n", test_array_values_torch.shape)
    print()

    colormap_torch = ColormapTorch.from_colormap("parula_norm_lab")

    colors_from_values_torch = colormap_torch.get_colors_from_values(test_array_values_torch)
    print("colors_from_values_torch:\n", colors_from_values_torch)
    print("colors_from_values_torch.shape:\n", colors_from_values_torch.shape)
    print()

    indexes_from_values_torch = colormap_torch.get_indexes_from_values(test_array_values_torch)
    print("indexes_from_values:\n", indexes_from_values_torch)
    print("indexes_from_values.shape:\n", indexes_from_values_torch.shape)
    print()

    colors_from_indexes_torch = colormap_torch.get_colors_from_indexes(indexes_from_values_torch)
    print("colors_from_indexes:\n", colors_from_indexes_torch)
    print("colors_from_indexes.shape:\n", colors_from_indexes_torch.shape)
    print()

    values_from_indexes_torch = colormap_torch.get_values_from_indexes(indexes_from_values_torch)
    print("values_from_indexes_torch:\n", values_from_indexes_torch)
    print("values_from_indexes_torch.shape:\n", values_from_indexes_torch.shape)
    print()

    indexes_from_colors_torch = colormap_torch.get_indexes_from_colors(colors_from_values_torch)
    print("indexes_from_colors_torch:\n", indexes_from_colors_torch)
    print("indexes_from_colors_torch.shape:\n", indexes_from_colors_torch.shape)
    print()

    values_from_colors_torch = colormap_torch.get_values_from_colors(colors_from_values_torch)
    print("values_from_colors_torch:\n", values_from_colors_torch)
    print("values_from_colors_torch.shape:\n", values_from_colors_torch.shape)
    print()
    
    # Assertions
    assert (indexes_from_values_torch==indexes_from_colors_torch).all()
    assert (colors_from_values_torch==colors_from_indexes_torch).all()
    assert (values_from_indexes_torch==values_from_colors_torch).all()
    
    # PyTorch vs NumPy
    eps = 1e-5  
    assert (test_array_values_torch[0].numpy()==test_array_values).all()
    assert (np.abs(colors_from_values_torch[0].permute((1,2,0)).numpy() - colors_from_values) < eps).all()
    assert (indexes_from_values_torch[0].permute((1,2,0)).squeeze().numpy() == indexes_from_values).all()
    assert (np.abs(colors_from_indexes_torch[0].permute((1,2,0)).numpy() - colors_from_indexes) < eps).all()
    assert (np.abs(values_from_indexes_torch[0].permute((1,2,0)).squeeze().numpy() - values_from_indexes) < eps).all() 
    assert (indexes_from_colors_torch[0].permute((1,2,0)).squeeze().numpy() == indexes_from_colors).all()
    assert (np.abs(values_from_colors_torch[0].permute((1,2,0)).squeeze().numpy() - values_from_colors) < eps).all()
    
    
    print("Performance tests(NumPy):")

    test_size = 10
    array_size = 512
    array_of_arrays = []
    
    for i in range(0,test_size):
        array_of_arrays.append(generate_random_array_nxn(array_size))
    
    times = []
    total_start = timer()
    for i in tqdm(range(0, test_size), leave=False):
        start = timer()
        colormap.get_colors_from_values(array_of_arrays[i])
        end = timer()
        times.append(end - start)
    total_end = timer()

    print("Dataset size:", test_size)
    print("Test array size:", array_size, "x", array_size)
    print("Average calculations time:", np.asarray(times).mean(), "seconds")
    print("Total time:", total_end - total_start, "seconds")
    
    print("Performance tests(PyTorch):")

    array_size = 512
    batch_size = test_size
    array_of_tensors = []

    batch = torch.cat([torch.from_numpy(generate_random_array_nxn(array_size))[None,None,:] for i in range(batch_size)])
    
    times = []
    start = timer()
    colormap_torch.get_colors_from_values(batch)
    end = timer()

    print("Batch size:", batch_size)
    print("Test array size:", array_size, "x", array_size)
    print("Total time:", end-start, "seconds")

    
    